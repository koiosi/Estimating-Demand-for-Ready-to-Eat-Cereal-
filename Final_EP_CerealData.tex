% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{float}
\usepackage{tabularray}
\usepackage[normalem]{ulem}
\usepackage{graphicx}
\UseTblrLibrary{booktabs}
\UseTblrLibrary{rotating}
\UseTblrLibrary{siunitx}
\NewTableCommand{\tinytableDefineColor}[3]{\definecolor{#1}{#2}{#3}}
\newcommand{\tinytableTabularrayUnderline}[1]{\underline{#1}}
\newcommand{\tinytableTabularrayStrikeout}[1]{\sout{#1}}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={EP\_Cereal},
  pdfauthor={Project with three other members, Canberk Atak},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{EP\_Cereal}
\author{Project with three other members, Canberk Atak}
\date{2025-10-03}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{getwd}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "C:/Users/muzaf/OneDrive/Masa端st端/Portfolio/Cereal_project/Estimating-Demand-for-Ready-to-Eat-Cereal-"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\SpecialCharTok{::}\NormalTok{opts\_chunk}\SpecialCharTok{$}\FunctionTok{set}\NormalTok{(}\AttributeTok{echo =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Libraries}\label{libraries}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readxl)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'readxl' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(data.table)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'data.table' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(haven)}
\FunctionTok{library}\NormalTok{(modelsummary)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'modelsummary' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## `modelsummary` 2.0.0 now uses `tinytable` as its default table-drawing
##   backend. Learn more at: https://vincentarelbundock.github.io/tinytable/
## 
## Revert to `kableExtra` for one session:
## 
##   options(modelsummary_factory_default = 'kableExtra')
##   options(modelsummary_factory_latex = 'kableExtra')
##   options(modelsummary_factory_html = 'kableExtra')
## 
## Silence this message forever:
## 
##   config_modelsummary(startup_message = FALSE)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'ggplot2' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'tidyr' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.4     v readr     2.1.5
## v forcats   1.0.0     v stringr   1.5.1
## v lubridate 1.9.3     v tibble    3.2.1
## v purrr     1.0.2     v tidyr     1.3.1
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::between()     masks data.table::between()
## x dplyr::filter()      masks stats::filter()
## x dplyr::first()       masks data.table::first()
## x lubridate::hour()    masks data.table::hour()
## x lubridate::isoweek() masks data.table::isoweek()
## x dplyr::lag()         masks stats::lag()
## x dplyr::last()        masks data.table::last()
## x lubridate::mday()    masks data.table::mday()
## x lubridate::minute()  masks data.table::minute()
## x lubridate::month()   masks data.table::month()
## x lubridate::quarter() masks data.table::quarter()
## x lubridate::second()  masks data.table::second()
## x purrr::transpose()   masks data.table::transpose()
## x lubridate::wday()    masks data.table::wday()
## x lubridate::week()    masks data.table::week()
## x lubridate::yday()    masks data.table::yday()
## x lubridate::year()    masks data.table::year()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(tidyr)}
\FunctionTok{library}\NormalTok{(naniar)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'naniar' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(fixest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'fixest' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lfe)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'lfe' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## Zorunlu paket y端kleniyor: Matrix
## 
## Attaching package: 'Matrix'
## 
## The following objects are masked from 'package:tidyr':
## 
##     expand, pack, unpack
## 
## 
## Attaching package: 'lfe'
## 
## The following object is masked from 'package:fixest':
## 
##     fepois
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(sandwich)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'sandwich' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lmtest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Zorunlu paket y端kleniyor: zoo
## 
## Attaching package: 'zoo'
## 
## The following objects are masked from 'package:data.table':
## 
##     yearmon, yearqtr
## 
## The following objects are masked from 'package:base':
## 
##     as.Date, as.Date.numeric
## 
## 
## Attaching package: 'lmtest'
## 
## The following object is masked from 'package:lfe':
## 
##     waldtest
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(knitr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'knitr' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(corrplot)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'corrplot' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## corrplot 0.95 loaded
\end{verbatim}

\#Import data:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{datapath }\OtherTok{\textless{}{-}} \FunctionTok{file.path}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{"Cereal\_Data.xls"}\NormalTok{) }
\NormalTok{cerealdata }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(datapath)}
\end{Highlighting}
\end{Shaded}

\section{TASK 1}\label{task-1}

1. \textbf{Data Description.} \textbf{Provide a brief, non-technical,
overview of the market using descriptive tools (tables, plots) and
focusing on a lay audience. Which are the salient features of the
market, the main brands, segments, and products?}

Missing observations:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sapply}\NormalTok{(cerealdata, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               0            Name Avg Trans Price Avg Shelf Price     Avg Ad Expn 
##               0               0               0               1               0 
##       Mkt Share           Sgmnt            Cals             Fat           Sugar 
##               0               1               1               1               1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(naniar)}
\FunctionTok{vis\_miss}\NormalTok{(cerealdata, }\AttributeTok{warn\_large\_data =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-6-1.pdf}

In total 1\% of observations are missing values.

\subsection{Remove rows with missing
values}\label{remove-rows-with-missing-values}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(cerealdata)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{datasummary}\NormalTok{( }\FunctionTok{All}\NormalTok{(cerealdata) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mean }\SpecialCharTok{+}\NormalTok{ sd }\SpecialCharTok{+}\NormalTok{ min }\SpecialCharTok{+}\NormalTok{ median }\SpecialCharTok{+}\NormalTok{ max, }\AttributeTok{fmt =} \DecValTok{4}\NormalTok{, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{output =} \StringTok{"markdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tblr}[         %% tabularray outer open
]                     %% tabularray outer close
{                     %% tabularray inner open
colspec={Q[]Q[]Q[]Q[]Q[]Q[]},
column{1}={halign=l,},
column{2}={halign=r,},
column{3}={halign=r,},
column{4}={halign=r,},
column{5}={halign=r,},
column{6}={halign=r,},
}                     %% tabularray inner close
\toprule
& mean & sd & min & median & max \\ \midrule %% TinyTableHeader
0               & 25.5000  & 14.5774 & 1.0000   & 25.5000  & 50.0000  \\
Avg Trans Price & 2.9830   & 0.4916  & 1.7700   & 3.0150   & 3.9600   \\
Avg Shelf Price & 3.2418   & 0.5262  & 1.7700   & 3.4000   & 4.2200   \\
Avg Ad Expn     & 2.8643   & 1.9049  & 0.0000   & 2.5435   & 7.8670   \\
Mkt Share       & 1.5154   & 1.0247  & 0.6700   & 1.1500   & 5.6700   \\
Cals            & 145.6200 & 41.5397 & 100.0000 & 120.0000 & 220.0000 \\
Fat             & 1.6080   & 1.6884  & 0.0000   & 1.0000   & 8.0000   \\
Sugar           & 10.1080  & 5.4177  & 0.0000   & 11.2500  & 20.0000  \\
\bottomrule
\end{tblr}
\end{table}

\#\#discount\&coupons

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create a variable "coupon"}
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{coupon =} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Group, breakfast cereals under the different market segment }
\NormalTok{avg\_prices\_by\_segment }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Sgmnt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{AvgShelfPrice =} \FunctionTok{mean}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}

\FunctionTok{print}\NormalTok{(avg\_prices\_by\_segment)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   Sgmnt AvgShelfPrice
##   <chr>         <dbl>
## 1 Adult          3.20
## 2 Fam            3.08
## 3 Kids           3.51
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Different prices for consumer heterogeneity}

\NormalTok{plot\_1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(cerealdata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sgmnt, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =}\NormalTok{ Sgmnt)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Segment"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Average Shelf Price"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Pastel1"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"italic"}\NormalTok{))}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Comparison of Average Shelf Prices by Segment.jpeg"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ plot\_1, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{600}\NormalTok{)}

\FunctionTok{print}\NormalTok{(plot\_1)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# }
\CommentTok{\# \# Top 10 cereals in the market based on their Market share}
\CommentTok{\# }
\CommentTok{\# plot\_2 \textless{}{-} cerealdata \%\textgreater{}\%}
\CommentTok{\#   top\_n(10, \textasciigrave{}Mkt Share\textasciigrave{}) \%\textgreater{}\%}
\CommentTok{\#   ggplot(aes(x = reorder(Name, \textasciigrave{}Mkt Share\textasciigrave{}), y = \textasciigrave{}Mkt Share\textasciigrave{})) +}
\CommentTok{\#   geom\_bar(stat = "identity", fill = "darkblue") +}
\CommentTok{\#   coord\_flip() + \# This makes it horizontal for better readability}
\CommentTok{\#   labs(title = "Top 10 Cereals by Market Share", x = "", y = "Market Share (\%)") +}
\CommentTok{\#   theme\_minimal()}
\CommentTok{\# }
\CommentTok{\# print(plot\_2)}
\CommentTok{\# }
\CommentTok{\# ggsave(filename = "Top 10 Cereals by Market Share.jpeg" ,plot\_2 )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Seeing the different price and different nutritional values}
\CommentTok{\# Identifying the row with the maximum value for each variable}

\NormalTok{max\_fat }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata[}\FunctionTok{which.max}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Fat),]}
\NormalTok{max\_cals }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata[}\FunctionTok{which.max}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Cals),]}
\NormalTok{max\_sugar }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata[}\FunctionTok{which.max}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Sugar),]}
\NormalTok{max\_price }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata[}\FunctionTok{which.max}\NormalTok{(cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{),]}

\CommentTok{\# Combining these into a single data frame for annotation}
\NormalTok{max\_values }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(max\_fat, max\_cals, max\_sugar, max\_price)}

\NormalTok{plot\_3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(cerealdata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sugar, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{size =}\NormalTok{ Cals, }\AttributeTok{color =}\NormalTok{ Fat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_label}\NormalTok{(}\AttributeTok{data =}\NormalTok{ max\_values, }
             \FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{paste}\NormalTok{(}\StringTok{"F:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(Fat,}\DecValTok{1}\NormalTok{), }\StringTok{"C:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(Cals,}\DecValTok{0}\NormalTok{), }\StringTok{"S:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(Sugar,}\DecValTok{0}\NormalTok{), }\StringTok{"P:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{,}\DecValTok{2}\NormalTok{))), }
             \AttributeTok{hjust =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{vjust =} \FloatTok{1.5}\NormalTok{, }
             \AttributeTok{size =} \DecValTok{3}\NormalTok{,}
             \AttributeTok{label.size =} \ConstantTok{NA}\NormalTok{,}
             \AttributeTok{lineheight =} \FloatTok{0.9}\NormalTok{, }
             \AttributeTok{fontface =} \StringTok{"italic"}\NormalTok{, }
             \AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_gradient}\NormalTok{(}\AttributeTok{low =} \StringTok{"yellow"}\NormalTok{, }\AttributeTok{high =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Sugar Content (S)"}\NormalTok{, }
       \AttributeTok{y =} \StringTok{"Avg Shelf Price (P)"}\NormalTok{, }
       \AttributeTok{color =} \StringTok{"Fat Content"}\NormalTok{, }
       \AttributeTok{size =} \StringTok{"Calorie Count"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{color =} \FunctionTok{guide\_colourbar}\NormalTok{(}\AttributeTok{title =} \StringTok{"Fat (F)"}\NormalTok{), }\AttributeTok{size =} \FunctionTok{guide\_legend}\NormalTok{(}\AttributeTok{title =} \StringTok{"Calories (C)"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"right"}\NormalTok{)}


\FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"Average Shelf Price vs. Nutritional Values.jpeg"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ plot\_3, }\AttributeTok{dpi =} \DecValTok{900}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saving 6.5 x 4.5 in image
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(plot\_3)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ggplot(cerealdata, aes(x = \textasciigrave{}Avg Ad Expn\textasciigrave{}, y = coupon)) +}
\CommentTok{\#   geom\_point(aes(color = Sgmnt), alpha = 0.7) + }
\CommentTok{\#   geom\_smooth(method = "lm", se = FALSE, color = "gray") +}
\CommentTok{\#   labs(title = "Relationship Between Advertising Expenses and Discounts",}
\CommentTok{\#        x = "Average Advertising Expenditure",}
\CommentTok{\#        y = "Discount Amount") +}
\CommentTok{\#   theme\_minimal() +}
\CommentTok{\#   scale\_color\_brewer(palette = "Pastel1")}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Different Discounts for different Segment}

\NormalTok{plot\_4 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(cerealdata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sgmnt, }\AttributeTok{y =}\NormalTok{ coupon, }\AttributeTok{fill =}\NormalTok{ Sgmnt)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Segment"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Discount Amount"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Pastel1"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept =} \DecValTok{0}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{linewidth =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"italic"}\NormalTok{))}


\FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"Discount Distribution by Segment.jpeg"}\NormalTok{,}\AttributeTok{plot =}\NormalTok{ plot\_4, }\AttributeTok{dpi =} \DecValTok{600}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saving 6.5 x 4.5 in image
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(plot\_4)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-14-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# }

\NormalTok{plot\_5 }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Sgmnt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{AvgCalories =} \FunctionTok{mean}\NormalTok{(Cals, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{AvgFat =} \FunctionTok{mean}\NormalTok{(Fat, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{AvgSugar =} \FunctionTok{mean}\NormalTok{(Sugar, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{gather}\NormalTok{(}\AttributeTok{key =} \StringTok{"Nutrient"}\NormalTok{, }\AttributeTok{value =} \StringTok{"Average"}\NormalTok{, }\SpecialCharTok{{-}}\NormalTok{Sgmnt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sgmnt, }\AttributeTok{y =}\NormalTok{ Average, }\AttributeTok{fill =}\NormalTok{ Nutrient)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Segment"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Average Value"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Pastel1"}\NormalTok{)}


\FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"Average Nutritional Values by Segment.jpeg"}\NormalTok{,}\AttributeTok{plot =}\NormalTok{ plot\_5, }\AttributeTok{dpi =} \DecValTok{600}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saving 6.5 x 4.5 in image
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(plot\_5)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-15-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{unique\_product }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Name)}
\NormalTok{unique\_product}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "KG Corn Flakes"           "GM Cheerios"             
##  [3] "KG Rice Krispies"         "KG Frosted Flakes"       
##  [5] "KG Raisin Bran"           "GM Total"                
##  [7] "GM HoneyNut Cheerios"     "KG Special K"            
##  [9] "PT Grape Nuts"            "NB SpoonSize ShdWt"      
## [11] "QK 100% Natural"          "KG Frosted Mini Wheats"  
## [13] "KG NutriGrain"            "KG Muesliz"              
## [15] "GM Wheaties"              "PT Raisin Bran"          
## [17] "RL Muesli"                "KG Corn Pops"            
## [19] "GM Raisin Nut Bran"       "GM Basic 4"              
## [21] "GM Cocoa Puffs"           "GM Golden Grahams"       
## [23] "GM Cinn. Toast Crunch"    "KG Froot Loops"          
## [25] "KG Low Fat Granola"       "GM Trix"                 
## [27] "GM Triples"               "KG Crispix"              
## [29] "GM Kix"                   "GM Lucky Charms"         
## [31] "GM AppleCinn. Cheerios"   "KG Cracklin Oat Bran"    
## [33] "NB Big Biscuit Shd Wt"    "PT Honey Bunches of Oats"
## [35] "PT Great Graines"         "GM Otml Raisin Crisp"    
## [37] "QK Oat Sqyares"           "RL Rice Chex"            
## [39] "GM Total Raisin Bran"     "KG Product 19"           
## [41] "KG Apple Jacks"           "QK Capt Crunch"          
## [43] "NB Shredded Wheat"        "PT Fuity Pebbles"        
## [45] "GM Clusters"              "KG Cinnamon MiniBuns"    
## [47] "KG Double Dip Crunch"     "GM MultiGrain Cheerios"  
## [49] "PT Honeycomb"             "QK Popeye"
\end{verbatim}

\#\#brand

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Brand =} \FunctionTok{sub}\NormalTok{(}\StringTok{" .*"}\NormalTok{, }\StringTok{""}\NormalTok{, Name))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{unique\_brand }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Brand)}
\NormalTok{unique\_brand}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "KG" "GM" "PT" "NB" "QK" "RL"
\end{verbatim}

\subsection{Plots of market share grouped by
brand}\label{plots-of-market-share-grouped-by-brand}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculating total market share for each brand}
\NormalTok{df\_brand }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Brand) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{total\_market\_share =} \FunctionTok{sum}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(total\_market\_share))}

\CommentTok{\# Plot}
\NormalTok{plot\_6 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(df\_brand, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(Brand, total\_market\_share), }\AttributeTok{y =}\NormalTok{ total\_market\_share, }\AttributeTok{fill =}\NormalTok{ Brand)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ total\_market\_share), }\AttributeTok{position =} \FunctionTok{position\_stack}\NormalTok{(}\AttributeTok{vjust =} \FloatTok{0.5}\NormalTok{), }\AttributeTok{size =} \FloatTok{3.5}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Brand"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Total Market Share (\%)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Market Share by Brands.jpeg"}\NormalTok{, plot\_6)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saving 6.5 x 4.5 in image
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(plot\_6)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-19-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Counting the number of products for each brand}
\NormalTok{brand\_counts }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Brand) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Products =} \FunctionTok{n}\NormalTok{())}

\CommentTok{\# Creating a bar plot showing the number of products for each brand}
\NormalTok{plot\_7 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(brand\_counts, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(Brand, Products), }\AttributeTok{y =}\NormalTok{ Products, }\AttributeTok{fill =}\NormalTok{ Brand)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ Products), }\AttributeTok{position =} \FunctionTok{position\_stack}\NormalTok{(}\AttributeTok{vjust =} \FloatTok{0.5}\NormalTok{), }\AttributeTok{size =} \FloatTok{3.5}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_flip}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Brand"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Number of Products"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Number of Products by Brand.jpeg"}\NormalTok{, plot\_7)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saving 6.5 x 4.5 in image
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(plot\_7)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-20-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{unique\_product }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Name)}
\NormalTok{unique\_product}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "KG Corn Flakes"           "GM Cheerios"             
##  [3] "KG Rice Krispies"         "KG Frosted Flakes"       
##  [5] "KG Raisin Bran"           "GM Total"                
##  [7] "GM HoneyNut Cheerios"     "KG Special K"            
##  [9] "PT Grape Nuts"            "NB SpoonSize ShdWt"      
## [11] "QK 100% Natural"          "KG Frosted Mini Wheats"  
## [13] "KG NutriGrain"            "KG Muesliz"              
## [15] "GM Wheaties"              "PT Raisin Bran"          
## [17] "RL Muesli"                "KG Corn Pops"            
## [19] "GM Raisin Nut Bran"       "GM Basic 4"              
## [21] "GM Cocoa Puffs"           "GM Golden Grahams"       
## [23] "GM Cinn. Toast Crunch"    "KG Froot Loops"          
## [25] "KG Low Fat Granola"       "GM Trix"                 
## [27] "GM Triples"               "KG Crispix"              
## [29] "GM Kix"                   "GM Lucky Charms"         
## [31] "GM AppleCinn. Cheerios"   "KG Cracklin Oat Bran"    
## [33] "NB Big Biscuit Shd Wt"    "PT Honey Bunches of Oats"
## [35] "PT Great Graines"         "GM Otml Raisin Crisp"    
## [37] "QK Oat Sqyares"           "RL Rice Chex"            
## [39] "GM Total Raisin Bran"     "KG Product 19"           
## [41] "KG Apple Jacks"           "QK Capt Crunch"          
## [43] "NB Shredded Wheat"        "PT Fuity Pebbles"        
## [45] "GM Clusters"              "KG Cinnamon MiniBuns"    
## [47] "KG Double Dip Crunch"     "GM MultiGrain Cheerios"  
## [49] "PT Honeycomb"             "QK Popeye"
\end{verbatim}

\subsection{Plots of market share grouped by
brand}\label{plots-of-market-share-grouped-by-brand-1}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}

\CommentTok{\# Calculate total market share for each brand}
\NormalTok{df\_brand }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Brand) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{total\_market\_share =} \FunctionTok{sum}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(total\_market\_share))}

\CommentTok{\# Plot}
\FunctionTok{ggplot}\NormalTok{(df\_brand, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(Brand, total\_market\_share), }\AttributeTok{y =}\NormalTok{ total\_market\_share, }\AttributeTok{fill =}\NormalTok{ Brand)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Market Share by Brand"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Brand"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Total Market Share (\%)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-22-1.pdf}

\section{TASK 2}\label{task-2}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \textbf{The basics and OLS estimation.} \textbf{Load the data, define
  the share of the outside good, create a variable to store the brand
  information and create the dependent variable to be used in the logit
  regressions (mean utility). Then estimate the following six
  specifications using OLS and including product characteristics Price,
  Cals, Fat, and Sugar:}
\end{enumerate}

Load data:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{datapath }\OtherTok{\textless{}{-}} \FunctionTok{file.path}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{"Cereal\_Data.xls"}\NormalTok{) }
\NormalTok{cerealdata }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(datapath)}
\NormalTok{cerealdata }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(cerealdata)}
\FunctionTok{names}\NormalTok{(cerealdata)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "0"               "Name"            "Avg Trans Price" "Avg Shelf Price"
##  [5] "Avg Ad Expn"     "Mkt Share"       "Sgmnt"           "Cals"           
##  [9] "Fat"             "Sugar"
\end{verbatim}

\emph{share of the outside good}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{outside\_share}\OtherTok{=}\DecValTok{100}\SpecialCharTok{{-}}\FunctionTok{round}\NormalTok{(}\FunctionTok{sum}\NormalTok{(cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\emph{brand information}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{Brand =} \FunctionTok{word}\NormalTok{(Name, }\DecValTok{1}\NormalTok{, }\AttributeTok{sep =} \StringTok{" "}\NormalTok{),}
    \AttributeTok{Product =} \FunctionTok{word}\NormalTok{(Name, }\DecValTok{2}\NormalTok{, }\AttributeTok{sep =} \StringTok{" "}\NormalTok{))}
\NormalTok{cerealdata}\SpecialCharTok{$}\NormalTok{fbrand }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Brand)}
\NormalTok{cerealdata}\SpecialCharTok{$}\NormalTok{fsegment }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Sgmnt)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(cerealdata)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "0"               "Name"            "Avg Trans Price" "Avg Shelf Price"
##  [5] "Avg Ad Expn"     "Mkt Share"       "Sgmnt"           "Cals"           
##  [9] "Fat"             "Sugar"           "Brand"           "Product"        
## [13] "fbrand"          "fsegment"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dummy =} \FunctionTok{model.matrix}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ fbrand }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{, }\AttributeTok{data =}\NormalTok{ .))}
\end{Highlighting}
\end{Shaded}

\emph{mean utility as dependent variable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{mean\_utility =} \FunctionTok{log}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{log}\NormalTok{(outside\_share))}
\end{Highlighting}
\end{Shaded}

\textbf{Then estimate the following six specifications using OLS and
including product characteristics Price, Cals, Fat, and Sugar:}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(cerealdata)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "0"               "Name"            "Avg Trans Price" "Avg Shelf Price"
##  [5] "Avg Ad Expn"     "Mkt Share"       "Sgmnt"           "Cals"           
##  [9] "Fat"             "Sugar"           "Brand"           "Product"        
## [13] "fbrand"          "fsegment"        "dummy"           "mean_utility"
\end{verbatim}

\emph{(1) Without brand fixed-effects, standard errors assuming IID
errors;}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Model specification without brand fixed{-}effects and with IID standard errors}
\NormalTok{ols\_1 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar}\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)       -1.761605   0.609939 -2.888166 0.0059381 ** 
## Cals               0.000043   0.002495  0.017160 0.9863846    
## Fat               -0.000561   0.056523 -0.009931 0.9921202    
## Sugar             -0.028234   0.014011 -2.015177 0.0498831 *  
## `Avg Shelf Price` -0.267781   0.138457 -1.934033 0.0594128 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451604   Adj. R2: 0.102238
\end{verbatim}

\emph{(2) Without brand fixed-effects, heteroskedasticity-robust
standard errors;}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ols\_2 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar}\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{vcov =} \StringTok{"HC1"}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: Heteroskedasticity-robust 
##                    Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)       -1.761605   0.905637 -1.945156  0.05802 .  
## Cals               0.000043   0.002643  0.016200  0.98715    
## Fat               -0.000561   0.048321 -0.011617  0.99078    
## Sugar             -0.028234   0.016836 -1.677011  0.10047    
## `Avg Shelf Price` -0.267781   0.206625 -1.295980  0.20159    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451604   Adj. R2: 0.102238
\end{verbatim}

\emph{(3) Without brand fixed-effects, standard errors clustered at the
brand level}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ols\_3 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar}\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ , }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}cluster\textquotesingle{}}\NormalTok{, }\AttributeTok{cluster =} \StringTok{"Brand"}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: Clustered (Brand) 
##                    Estimate Std. Error   t value Pr(>|t|) 
## (Intercept)       -1.761605   1.045928 -1.684250  0.15295 
## Cals               0.000043   0.002113  0.020269  0.98461 
## Fat               -0.000561   0.061800 -0.009083  0.99310 
## Sugar             -0.028234   0.014568 -1.938138  0.11033 
## `Avg Shelf Price` -0.267781   0.287231 -0.932284  0.39398 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451604   Adj. R2: 0.102238
\end{verbatim}

\emph{By adding a brand fixed-effect I control for unobserved quality,}
\emph{(4) With brand fixed-effects, standard errors assuming IID
errors;}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ols\_4 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar}\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{|}\NormalTok{ fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## Cals               0.001039   0.002683  0.387330 0.7005651    
## Fat                0.015549   0.059908  0.259545 0.7965463    
## Sugar             -0.037275   0.014459 -2.577907 0.0137295 *  
## `Avg Shelf Price` -0.443217   0.154931 -2.860740 0.0066887 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391354     Adj. R2: 0.241534
##                  Within R2: 0.314077
\end{verbatim}

\emph{(5) With brand fixed-effects, heteroskedasticity-robust standard
errors}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ols\_5 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar}\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{|}\NormalTok{ fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{vcov =} \StringTok{\textquotesingle{}HC1\textquotesingle{}}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_5)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: Heteroskedasticity-robust 
##                    Estimate Std. Error   t value Pr(>|t|)    
## Cals               0.001039   0.002102  0.494363 0.623754    
## Fat                0.015549   0.054568  0.284942 0.777159    
## Sugar             -0.037275   0.015634 -2.384172 0.021950 *  
## `Avg Shelf Price` -0.443217   0.173060 -2.561059 0.014313 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391354     Adj. R2: 0.241534
##                  Within R2: 0.314077
\end{verbatim}

\emph{(6) With brand fixed-effects, standard errors clustered at the
brand level}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ols\_6 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar}\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{|}\NormalTok{ fbrand,  }\AttributeTok{data =}\NormalTok{ cerealdata)}
\FunctionTok{summary}\NormalTok{(ols\_6)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: Clustered (fbrand) 
##                    Estimate Std. Error   t value Pr(>|t|)    
## Cals               0.001039   0.001253  0.829313 0.444702    
## Fat                0.015549   0.072256  0.215190 0.838122    
## Sugar             -0.037275   0.010880 -3.426029 0.018716 *  
## `Avg Shelf Price` -0.443217   0.196848 -2.251563 0.074131 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391354     Adj. R2: 0.241534
##                  Within R2: 0.314077
\end{verbatim}

\#table with results\#

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{coef }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\StringTok{\textquotesingle{}Intercept\textquotesingle{}}\OtherTok{=}\StringTok{"Intercept"}\NormalTok{,}
              \StringTok{\textquotesingle{}Cals\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Caloric content of the product, per portion\textquotesingle{}}\NormalTok{,}
             \StringTok{\textquotesingle{}Fat\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Fat content of the product, per portion\textquotesingle{}}\NormalTok{,}
             \StringTok{\textquotesingle{}Sugar\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Sugar content of the product, per portion\textquotesingle{}}\NormalTok{,}
             \StringTok{\textquotesingle{}Avg Shelf Price\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Average shelf price\textquotesingle{}}\NormalTok{)}

\NormalTok{gof }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{raw =} \FunctionTok{c}\NormalTok{(}\StringTok{"nobs"}\NormalTok{, }\StringTok{"adj.r.squared"}\NormalTok{),}
                  \AttributeTok{clean =} \FunctionTok{c}\NormalTok{(}\StringTok{"Observations"}\NormalTok{, }\StringTok{"R2 adj."}\NormalTok{),}
                  \AttributeTok{fmt =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{))}

\NormalTok{fe }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{FE =} \FunctionTok{c}\NormalTok{(}\StringTok{"Brand FE"}\NormalTok{,}\StringTok{"errors"}\NormalTok{),}
                 \AttributeTok{mod1 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{,}\StringTok{"idd"}\NormalTok{),}
                 \AttributeTok{mod2 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{,}\StringTok{"HC1"}\NormalTok{),}
                 \AttributeTok{mod3 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{,}\StringTok{"clustered"}\NormalTok{),}
                 \AttributeTok{mod4 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"idd"}\NormalTok{),}
                 \AttributeTok{mod5 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"HC1"}\NormalTok{),}
                 \AttributeTok{mod6 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"clustered"}\NormalTok{))}
\FunctionTok{attr}\NormalTok{(fe, }\StringTok{"position"}\NormalTok{) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{11}\NormalTok{,}\DecValTok{12}\NormalTok{)}

\FunctionTok{modelsummary}\NormalTok{(}\FunctionTok{list}\NormalTok{(ols\_1, ols\_2, ols\_3, ols\_4, ols\_5,ols\_6),}
              \AttributeTok{stars =} \FunctionTok{c}\NormalTok{(}\StringTok{"*"} \OtherTok{=}\NormalTok{ .}\DecValTok{1}\NormalTok{, }\StringTok{"**"} \OtherTok{=}\NormalTok{ .}\DecValTok{05}\NormalTok{, }\StringTok{"***"} \OtherTok{=}\NormalTok{ .}\DecValTok{01}\NormalTok{),}
              \AttributeTok{title =} \StringTok{"Table 1: Analysis of cereal market using OLS with and without brand fixed{-}effects"}\NormalTok{,}\AttributeTok{gof\_map =}\NormalTok{ gof, }\AttributeTok{add\_rows =}\NormalTok{ fe, }\AttributeTok{output =} \StringTok{"markdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{talltblr}[         %% tabularray outer open
caption={Table 1: Analysis of cereal market using OLS with and without brand fixed-effects},
note{}={* p < 0.1, ** p < 0.05, *** p < 0.01},
]                     %% tabularray outer close
{                     %% tabularray inner open
colspec={Q[]Q[]Q[]Q[]Q[]Q[]Q[]},
column{1}={halign=l,},
column{2}={halign=c,},
column{3}={halign=c,},
column{4}={halign=c,},
column{5}={halign=c,},
column{6}={halign=c,},
column{7}={halign=c,},
hline{12}={1,2,3,4,5,6,7}{solid, 0.05em, black},
}                     %% tabularray inner close
\toprule
& (1) & (2) & (3) & (4) & (5) & (6) \\ \midrule %% TinyTableHeader
(Intercept)     & -1.762*** & -1.762* & -1.762    &           &          &           \\
& (0.610)   & (0.906) & (1.046)   &           &          &           \\
Cals            & 0.000     & 0.000   & 0.000     & 0.001     & 0.001    & 0.001     \\
& (0.002)   & (0.003) & (0.002)   & (0.003)   & (0.002)  & (0.001)   \\
Fat             & -0.001    & -0.001  & -0.001    & 0.016     & 0.016    & 0.016     \\
& (0.057)   & (0.048) & (0.062)   & (0.060)   & (0.055)  & (0.072)   \\
Sugar           & -0.028**  & -0.028  & -0.028    & -0.037**  & -0.037** & -0.037**  \\
& (0.014)   & (0.017) & (0.015)   & (0.014)   & (0.016)  & (0.011)   \\
Avg Shelf Price & -0.268*   & -0.268  & -0.268    & -0.443*** & -0.443** & -0.443*   \\
& (0.138)   & (0.207) & (0.287)   & (0.155)   & (0.173)  & (0.197)   \\
Brand FE        & No        & No      & No        & Yes       & Yes      & Yes       \\
errors          & idd       & HC1     & clustered & idd       & HC1      & clustered \\
Observations    & 50        & 50      & 50        & 50        & 50       & 50        \\
R2 adj.         & 0.102     & 0.102   & 0.102     & 0.242     & 0.242    & 0.242     \\
\bottomrule
\end{talltblr}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{discount\_coupon =} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{TASK 3}\label{task-3}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \textbf{Instruments and IV estimation. Construct instruments to
  account for price endogeneity and use them to perform IV estimation.
  Report estimates on a table with specifications differing according to
  the instruments used. Which instruments have you constructed, and why?
  Can one claim that the more the merrier when it comes to instruments
  in this case? Note. Use the OLS estimates without and with brand
  fixed-effects with your preferred standard errors. Instrument each of
  them with the instruments you constructed and report a table with 6-8
  specifications in total}.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(corrplot)}
\FunctionTok{library}\NormalTok{(openxlsx)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'openxlsx' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{fsgmnt =} \FunctionTok{as.factor}\NormalTok{(Sgmnt))}
\NormalTok{cor\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(cerealdata, }\AttributeTok{select =} \FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{, }\StringTok{"Avg Trans Price"}\NormalTok{ ,}\StringTok{"Avg Ad Expn"}\NormalTok{)))}
\FunctionTok{print}\NormalTok{(cor\_matrix)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 Avg Shelf Price Avg Trans Price Avg Ad Expn
## Avg Shelf Price       1.0000000       0.9393441  -0.1827008
## Avg Trans Price       0.9393441       1.0000000  -0.1768049
## Avg Ad Expn          -0.1827008      -0.1768049   1.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{correlation\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(cerealdata[, }\FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{,}\StringTok{"Avg Trans Price"}\NormalTok{,}\StringTok{"Avg Ad Expn"}\NormalTok{)])}

\FunctionTok{png}\NormalTok{(}\StringTok{"heatmap\_base.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{800}\NormalTok{, }\AttributeTok{height =} \DecValTok{1200}\NormalTok{, }\AttributeTok{res =} \DecValTok{300}\NormalTok{)}
\FunctionTok{heatmap}\NormalTok{(correlation\_matrix)}
\FunctionTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{png}\NormalTok{(}\StringTok{"heatmap\_corrplot.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{800}\NormalTok{, }\AttributeTok{height =}\DecValTok{1080}\NormalTok{, }\AttributeTok{res =}\DecValTok{150}\NormalTok{)}
\FunctionTok{corrplot}\NormalTok{(correlation\_matrix, }\AttributeTok{method =} \StringTok{"color"}\NormalTok{,}
         \AttributeTok{type =} \StringTok{"upper"}\NormalTok{, }
         \AttributeTok{order =} \StringTok{"hclust"}\NormalTok{, }
         \AttributeTok{addCoef.col =} \StringTok{"black"}\NormalTok{, }
         \AttributeTok{col =} \FunctionTok{colorRampPalette}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"lightblue"}\NormalTok{, }\StringTok{"darkblue"}\NormalTok{))(}\DecValTok{200}\NormalTok{), }
         \AttributeTok{title =} \StringTok{"Correlation Matrix"}\NormalTok{, }
         \AttributeTok{tl.col =} \StringTok{"black"}\NormalTok{, }\AttributeTok{tl.srt =} \DecValTok{30}\NormalTok{) }
\FunctionTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  OLS with fixed effects}
\FunctionTok{summary}\NormalTok{(ols1\_1 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)       -1.761605   0.609939 -2.888166 0.0059381 ** 
## Cals               0.000043   0.002495  0.017160 0.9863846    
## Fat               -0.000561   0.056523 -0.009931 0.9921202    
## Sugar             -0.028234   0.014011 -2.015177 0.0498831 *  
## `Avg Shelf Price` -0.267781   0.138457 -1.934033 0.0594128 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451604   Adj. R2: 0.102238
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#IV with average advertising expenditure * brand}
\FunctionTok{summary}\NormalTok{(iv1a\_2 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Ad Expn}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Ad Expn`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)           -0.478423   1.173293 -0.407761 0.685383    
## fit_`Avg Shelf Price` -0.597983   0.291552 -2.051032 0.046113 *  
## Cals                  -0.001983   0.003066 -0.646822 0.521033    
## Fat                    0.017643   0.061574  0.286537 0.775782    
## Sugar                 -0.022990   0.015398 -1.493041 0.142405    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.479295   Adj. R2: -0.01123
## F-test (1st stage), `Avg Shelf Price`: stat =  2.27027, p = 0.055895, on 6 and 40 DoF.
##                            Wu-Hausman: stat =  1.97898, p = 0.166522, on 1 and 44 DoF.
##                                Sargan: stat = 29.9    , p = 1.567e-5, on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# IV with average average transaction price * brand}
\FunctionTok{summary}\NormalTok{(iv1a\_3 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar  }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Trans Price`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)           -1.924107   0.641137 -3.001085 0.0043766 ** 
## fit_`Avg Shelf Price` -0.225965   0.147458 -1.532395 0.1324258    
## Cals                   0.000299   0.002517  0.118955 0.9058403    
## Fat                   -0.002867   0.056648 -0.050606 0.9598632    
## Sugar                 -0.028898   0.014048 -2.057149 0.0454953 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.452062   Adj. R2: 0.100418
## F-test (1st stage), `Avg Shelf Price`: stat = 50.5     , p < 2.2e-16 , on 6 and 40 DoF.
##                            Wu-Hausman: stat =  0.686471, p = 0.411839, on 1 and 44 DoF.
##                                Sargan: stat = 11.4     , p = 0.044186, on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  IV with average average transaction price * brand + advertising expenditure * brand}
\FunctionTok{summary}\NormalTok{(iv1a\_4 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Ad Expn}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Trans Price`:fbrand, fbrand:`Avg Ad Expn`
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)           -1.808195   0.635155 -2.846857 0.006629 ** 
## fit_`Avg Shelf Price` -0.255792   0.145769 -1.754778 0.086104 .  
## Cals                   0.000116   0.002511  0.046347 0.963239    
## Fat                   -0.001222   0.056583 -0.021602 0.982861    
## Sugar                 -0.028425   0.014031 -2.025900 0.048729 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451642   Adj. R2: 0.102088
## F-test (1st stage), `Avg Shelf Price`: stat = 26.2     , p = 1.084e-13, on 12 and 34 DoF.
##                            Wu-Hausman: stat =  0.067851, p = 0.795707 , on 1 and 44 DoF.
##                                Sargan: stat = 39.6     , p = 4.197e-5 , on 11 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  benchmark: OLS with fixed effects}
\FunctionTok{summary}\NormalTok{(ols\_4\_1 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{|}\NormalTok{ fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## Cals               0.001039   0.002683  0.387330 0.7005651    
## Fat                0.015549   0.059908  0.259545 0.7965463    
## Sugar             -0.037275   0.014459 -2.577907 0.0137295 *  
## `Avg Shelf Price` -0.443217   0.154931 -2.860740 0.0066887 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391354     Adj. R2: 0.241534
##                  Within R2: 0.314077
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#IV with average advertising expenditure * brand}
\FunctionTok{summary}\NormalTok{(iv2a\_5 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{|}\NormalTok{ fbrand }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Ad Expn}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand,}
                        \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Ad Expn`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## fit_`Avg Shelf Price` -0.898467   0.285491 -3.147097 0.003111 ** 
## Cals                  -0.002118   0.003356 -0.630992 0.531635    
## Fat                    0.063925   0.070388  0.908181 0.369222    
## Sugar                 -0.029515   0.016414 -1.798221 0.079692 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.431529     Adj. R2: 0.077814
##                  Within R2: 0.166016
## F-test (1st stage), `Avg Shelf Price`: stat =  3.25392, p = 0.01198 , on 6 and 35 DoF.
##                            Wu-Hausman: stat =  5.33872, p = 0.026234, on 1 and 39 DoF.
##                                Sargan: stat = 24.4    , p = 1.82e-4 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  IV with  average transaction price * brand}
\FunctionTok{summary}\NormalTok{(iv2a\_6 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{|}\NormalTok{ fbrand }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }
                        \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Trans Price`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## fit_`Avg Shelf Price` -0.409198   0.169093 -2.419955 0.020159 *  
## Cals                   0.001275   0.002725  0.467916 0.642384    
## Fat                    0.011934   0.060372  0.197672 0.844303    
## Sugar                 -0.037855   0.014514 -2.608192 0.012736 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391589     Adj. R2: 0.24062
##                  Within R2: 0.31325
## F-test (1st stage), `Avg Shelf Price`: stat = 30.7     , p = 1.451e-12, on 6 and 35 DoF.
##                            Wu-Hausman: stat =  0.249329, p = 0.620353 , on 1 and 39 DoF.
##                                Sargan: stat =  9.92037 , p = 0.077523 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  IV with both  average transaction price * brand and advertising expenditure * brand}
\FunctionTok{summary}\NormalTok{(iv2a\_7 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{|}\NormalTok{ fbrand }\SpecialCharTok{|}
                               \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Ad Expn}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand,}
                             \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## The instrument 'fbrandRL:`Avg Trans Price`' has been removed because of collinearity (see $collin.var).
\end{verbatim}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Ad Expn`:fbrand, fbrand:`Avg Trans Price`
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## fit_`Avg Shelf Price` -0.445565   0.167196 -2.664918 0.011051 *  
## Cals                   0.001023   0.002718  0.376324 0.708665    
## Fat                    0.015798   0.060279  0.262085 0.794601    
## Sugar                 -0.037235   0.014499 -2.568092 0.014067 *  
## ... 1 variable was removed because of collinearity (fbrandRL:`Avg Trans Price`)
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391355     Adj. R2: 0.241529
##                  Within R2: 0.314073
## F-test (1st stage), `Avg Shelf Price`: stat = 16.6     , p = 7.478e-10, on 11 and 30 DoF.
##                            Wu-Hausman: stat =  0.001361, p = 0.970765 , on 1 and 39 DoF.
##                                Sargan: stat = 39.5     , p = 4.323e-5 , on 11 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Define coefficients}
\NormalTok{coef }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\StringTok{\textquotesingle{}Intercept\textquotesingle{}}\OtherTok{=}\StringTok{"Intercept"}\NormalTok{,}
             \StringTok{\textquotesingle{}Cals\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Caloric content of the product, per portion\textquotesingle{}}\NormalTok{,}
             \StringTok{\textquotesingle{}Fat\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Fat content of the product, per portion\textquotesingle{}}\NormalTok{,}
             \StringTok{\textquotesingle{}Sugar\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Sugar content of the product, per portion\textquotesingle{}}\NormalTok{,}
             \StringTok{\textquotesingle{}Avg Shelf Price\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Average shelf price\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Define goodness{-}of{-}fit dataframe}
\NormalTok{gof }\OtherTok{\textless{}{-}}  \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{raw =} \FunctionTok{c}\NormalTok{(}\StringTok{"nobs"}\NormalTok{, }\StringTok{"adj.r.squared"}\NormalTok{),}
                   \AttributeTok{clean =} \FunctionTok{c}\NormalTok{(}\StringTok{"Observations"}\NormalTok{, }\StringTok{"R2 adj."}\NormalTok{),}
                   \AttributeTok{fmt =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{))}

\CommentTok{\# Define fixed effects dataframe}
\NormalTok{fe }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{FE =} \FunctionTok{c}\NormalTok{(}\StringTok{"Brand FE"}\NormalTok{,}\StringTok{"Instruments"}\NormalTok{),}
                 \AttributeTok{mod1 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{,}\StringTok{"None"}\NormalTok{),}
                 \AttributeTok{mod2 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"Av. Adv Exp x Brand"}\NormalTok{),}
                 \AttributeTok{mod3 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{,}\StringTok{"Avg Trans Price x Brand"}\NormalTok{),}
                 \AttributeTok{mod4 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{,}\StringTok{"Avg Trans Price + Avg Trans Price x Brand"}\NormalTok{),}
                 \AttributeTok{mod5 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"None"}\NormalTok{),}
                 \AttributeTok{mod6 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"Av. Adv Exp x Brand"}\NormalTok{),}
                 \AttributeTok{mod7 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"Sugar x Brand"}\NormalTok{),}
                 \AttributeTok{mod8 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"Avg Trans Price  + Avg Trans Price x Brand"}\NormalTok{))}
                  
\FunctionTok{attr}\NormalTok{(fe, }\StringTok{"position"}\NormalTok{) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{14}\NormalTok{,}\DecValTok{15}\NormalTok{)}

\CommentTok{\# Generate model summary in markdown format}
\FunctionTok{modelsummary}\NormalTok{(}\FunctionTok{list}\NormalTok{(ols1\_1, iv1a\_2, iv1a\_3, iv1a\_4, ols\_4\_1, iv2a\_5, iv2a\_6,iv2a\_7),}
             \AttributeTok{stars =} \FunctionTok{c}\NormalTok{(}\StringTok{"*"} \OtherTok{=}\NormalTok{ .}\DecValTok{1}\NormalTok{, }\StringTok{"**"} \OtherTok{=}\NormalTok{ .}\DecValTok{05}\NormalTok{, }\StringTok{"***"} \OtherTok{=}\NormalTok{ .}\DecValTok{01}\NormalTok{),}
             \AttributeTok{output =} \StringTok{"markdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{talltblr}[         %% tabularray outer open
entry=none,label=none,
note{}={* p < 0.1, ** p < 0.05, *** p < 0.01},
]                     %% tabularray outer close
{                     %% tabularray inner open
colspec={Q[]Q[]Q[]Q[]Q[]Q[]Q[]Q[]Q[]},
column{1}={halign=l,},
column{2}={halign=c,},
column{3}={halign=c,},
column{4}={halign=c,},
column{5}={halign=c,},
column{6}={halign=c,},
column{7}={halign=c,},
column{8}={halign=c,},
column{9}={halign=c,},
hline{14}={1,2,3,4,5,6,7,8,9}{solid, 0.05em, black},
}                     %% tabularray inner close
\toprule
& (1) & (2) & (3) & (4) & (5) & (6) & (7) & (8) \\ \midrule %% TinyTableHeader
(Intercept)         & -1.762*** & -0.478   & -1.924*** & -1.808*** &           &           &          &          \\
& (0.610)   & (1.173)  & (0.641)   & (0.635)   &           &           &          &          \\
Cals                & 0.000     & -0.002   & 0.000     & 0.000     & 0.001     & -0.002    & 0.001    & 0.001    \\
& (0.002)   & (0.003)  & (0.003)   & (0.003)   & (0.003)   & (0.003)   & (0.003)  & (0.003)  \\
Fat                 & -0.001    & 0.018    & -0.003    & -0.001    & 0.016     & 0.064     & 0.012    & 0.016    \\
& (0.057)   & (0.062)  & (0.057)   & (0.057)   & (0.060)   & (0.070)   & (0.060)  & (0.060)  \\
Sugar               & -0.028**  & -0.023   & -0.029**  & -0.028**  & -0.037**  & -0.030*   & -0.038** & -0.037** \\
& (0.014)   & (0.015)  & (0.014)   & (0.014)   & (0.014)   & (0.016)   & (0.015)  & (0.014)  \\
Avg Shelf Price     & -0.268*   &          &           &           & -0.443*** &           &          &          \\
& (0.138)   &          &           &           & (0.155)   &           &          &          \\
fit_Avg Shelf Price &           & -0.598** & -0.226    & -0.256*   &           & -0.898*** & -0.409** & -0.446** \\
&           & (0.292)  & (0.147)   & (0.146)   &           & (0.285)   & (0.169)  & (0.167)  \\
Num.Obs.            & 50        & 50       & 50        & 50        & 50        & 50        & 50       & 50       \\
R2                  & 0.176     & 0.071    & 0.174     & 0.175     & 0.381     & 0.247     & 0.380    & 0.381    \\
R2 Adj.             & 0.102     & -0.011   & 0.100     & 0.102     & 0.242     & 0.078     & 0.241    & 0.242    \\
R2 Within           &           &          &           &           & 0.314     & 0.166     & 0.313    & 0.314    \\
R2 Within Adj.      &           &          &           &           & 0.245     & 0.083     & 0.245    & 0.245    \\
AIC                 & 72.4      & 78.3     & 72.5      & 72.4      & 68.1      & 77.9      & 68.1     & 68.1     \\
BIC                 & 82.0      & 87.9     & 82.1      & 82.0      & 87.2      & 97.0      & 87.3     & 87.2     \\
RMSE                & 0.45      & 0.48     & 0.45      & 0.45      & 0.39      & 0.43      & 0.39     & 0.39     \\
Std.Errors          & IID       & IID      & IID       & IID       & IID       & IID       & IID      & IID      \\
FE: fbrand          &           &          &           &           & X         & X         & X        & X        \\
\bottomrule
\end{talltblr}
\end{table}

\subsection{Testing the Instrumental
variables:}\label{testing-the-instrumental-variables}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv1a\_2, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat =  2.27027 , p = 0.055895, on 6 and 40 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat =  2.27027 , p = 0.055895, on 6 and 40 DoF.
##                       Kleibergen-Paap: stat =  0.401331, p = 0.998841, on 6 DoF.
##                                Sargan: stat = 29.9     , p = 1.567e-5, on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv1a\_3, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 50.5    , p < 2.2e-16 , on 6 and 40 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 50.5    , p < 2.2e-16 , on 6 and 40 DoF.
##                       Kleibergen-Paap: stat =  8.93154, p = 0.177465, on 6 DoF.
##                                Sargan: stat = 11.4    , p = 0.044186, on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv1a\_4, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 26.2    , p = 1.084e-13, on 12 and 34 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 26.2    , p = 1.084e-13, on 12 and 34 DoF.
##                       Kleibergen-Paap: stat =  5.44514, p = 0.941437 , on 12 DoF.
##                                Sargan: stat = 39.6    , p = 4.197e-5 , on 11 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv2a\_5, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat =  3.25392, p = 0.01198 , on 6 and 35 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat =  3.25392, p = 0.01198 , on 6 and 35 DoF.
##                       Kleibergen-Paap: stat =  0.65739, p = 0.995365, on 6 DoF.
##                                Sargan: stat = 24.4    , p = 1.82e-4 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv2a\_6, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 30.7    , p = 1.451e-12, on 6 and 35 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 30.7    , p = 1.451e-12, on 6 and 35 DoF.
##                       Kleibergen-Paap: stat =  6.21107, p = 0.399966 , on 6 DoF.
##                                Sargan: stat =  9.92037, p = 0.077523 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv2a\_7, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 16.6    , p = 7.478e-10, on 11 and 30 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 16.6    , p = 7.478e-10, on 11 and 30 DoF.
##                       Kleibergen-Paap: stat =  3.90542, p = 0.972602 , on 11 DoF.
##                                Sargan: stat = 39.5    , p = 4.323e-5 , on 11 DoF.
\end{verbatim}

\section{TASK 4}\label{task-4}

\textbf{More instruments and IV estimation. In case you didn't get a
satisfactory specification, can you combine instruments to get better
results? If so, how? Report a table with your estimates.}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#price of other products within the same brand}
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(fbrand) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{brand\_av\_prices =} \FunctionTok{sum}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{))}

\CommentTok{\# Calculate iva variable}
\NormalTok{cerealdata}\SpecialCharTok{$}\NormalTok{iva }\OtherTok{\textless{}{-}} \FunctionTok{with}\NormalTok{(cerealdata, \{}
  \FunctionTok{ifelse}\NormalTok{(Brand }\SpecialCharTok{==} \StringTok{"GM"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{18}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (brand\_av\_prices}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{  ),}
  \FunctionTok{ifelse}\NormalTok{(Brand }\SpecialCharTok{==} \StringTok{"KG"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{17}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (brand\_av\_prices}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ),}
  \FunctionTok{ifelse}\NormalTok{(Brand }\SpecialCharTok{==} \StringTok{"NB"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{3}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (brand\_av\_prices}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ),}
  \FunctionTok{ifelse}\NormalTok{(Brand }\SpecialCharTok{==} \StringTok{"PT"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{6}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (brand\_av\_prices}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ),}
  \FunctionTok{ifelse}\NormalTok{(Brand }\SpecialCharTok{==} \StringTok{"QK"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{4}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (brand\_av\_prices}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ),}
  \FunctionTok{ifelse}\NormalTok{(Brand }\SpecialCharTok{==} \StringTok{"RL"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (brand\_av\_prices}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ),}
\NormalTok{         (brand\_av\_prices}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ )))))))\})}

\CommentTok{\# Compute correlation}

\FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(cerealdata, }\AttributeTok{select =} \FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{, }\StringTok{"iva"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 Avg Shelf Price       iva
## Avg Shelf Price       1.0000000 0.3420604
## iva                   0.3420604 1.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# discount coupon}
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ivb =}\NormalTok{ discount\_coupon)}

\FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(cerealdata, }\AttributeTok{select =} \FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{, }\StringTok{"ivb"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 Avg Shelf Price       ivb
## Avg Shelf Price       1.0000000 0.3569142
## ivb                   0.3569142 1.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{fsegment)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Adult   Fam  Kids 
##    25    13    12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# price by segment}
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(fsegment) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{segment\_av\_prices =} \FunctionTok{sum}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{))}

\NormalTok{cerealdata}\SpecialCharTok{$}\NormalTok{ivc }\OtherTok{\textless{}{-}} \FunctionTok{with}\NormalTok{(cerealdata, \{}
  \FunctionTok{ifelse}\NormalTok{(fsegment }\SpecialCharTok{==} \StringTok{"Adult"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{25}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (segment\_av\_prices }\SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{  ),}
  \FunctionTok{ifelse}\NormalTok{(fsegment }\SpecialCharTok{==} \StringTok{"Fam"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{13}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (segment\_av\_prices }\SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ),}
  \FunctionTok{ifelse}\NormalTok{(fsegment }\SpecialCharTok{==} \StringTok{"Kids"}\NormalTok{, (}\DecValTok{1}\SpecialCharTok{/}\DecValTok{12}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (segment\_av\_prices }\SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ),}
\NormalTok{         (segment\_av\_prices }\SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{ ))))\})}

\CommentTok{\# Compute correlation}

\FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(cerealdata, }\AttributeTok{select =} \FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{, }\StringTok{"ivc"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 Avg Shelf Price        ivc
## Avg Shelf Price      1.00000000 0.03176738
## ivc                  0.03176738 1.00000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(cerealdata, }\AttributeTok{select =} \FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{, }\StringTok{"iva"}\NormalTok{, }\StringTok{"ivb"}\NormalTok{, }\StringTok{"ivc"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 Avg Shelf Price        iva        ivb         ivc
## Avg Shelf Price      1.00000000  0.3420604  0.3569142  0.03176738
## iva                  0.34206040  1.0000000  0.1664130 -0.31285101
## ivb                  0.35691423  0.1664130  1.0000000 -0.15762185
## ivc                  0.03176738 -0.3128510 -0.1576219  1.00000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compute correlation matrix}
\NormalTok{corr }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(cerealdata, }\AttributeTok{select =} \FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{, }\StringTok{"iva"}\NormalTok{, }\StringTok{"ivb"}\NormalTok{, }\StringTok{"ivc"}\NormalTok{)))}

\CommentTok{\# Plot heatmap with variable names}
\FunctionTok{heatmap}\NormalTok{(corr, }\AttributeTok{labRow =} \FunctionTok{c}\NormalTok{(}\StringTok{"Avg Shelf Price"}\NormalTok{, }\StringTok{"iva"}\NormalTok{, }\StringTok{"ivb"}\NormalTok{, }\StringTok{"ivc"}\NormalTok{), }
        \AttributeTok{labCol =} \FunctionTok{c}\NormalTok{(}\StringTok{"ASPrice"}\NormalTok{, }\StringTok{"iva"}\NormalTok{, }\StringTok{"ivb"}\NormalTok{, }\StringTok{"ivc"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-51-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#model}
\FunctionTok{summary}\NormalTok{(ols2\_1 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)       -1.761605   0.609939 -2.888166 0.0059381 ** 
## Cals               0.000043   0.002495  0.017160 0.9863846    
## Fat               -0.000561   0.056523 -0.009931 0.9921202    
## Sugar             -0.028234   0.014011 -2.015177 0.0498831 *  
## `Avg Shelf Price` -0.267781   0.138457 -1.934033 0.0594128 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451604   Adj. R2: 0.102238
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv3c\_1 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ iva, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##             Estimate Std. Error t value   Pr(>|t|)    
## (Intercept) 2.255939   0.397238 5.67906 7.7228e-07 ***
## iva         0.343951   0.136380 2.52200 1.5041e-02 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.489458   Adj. R2: 0.09861
## F-test (1st stage): stat = 6.36046, p = 0.015041, on 1 and 48 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error  t value  Pr(>|t|)    
## (Intercept)           -4.876437   1.740648 -2.80151 0.0073116 ** 
## fit_`Avg Shelf Price`  0.606663   0.536130  1.13156 0.2634412    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.661805   Adj. R2: -0.807491
## F-test (1st stage), `Avg Shelf Price`: stat = 6.36046, p = 0.015041, on 1 and 48 DoF.
##                            Wu-Hausman: stat = 6.61965, p = 0.013304, on 1 and 47 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv3c\_2 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivb, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivb
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##             Estimate Std. Error  t value  Pr(>|t|)    
## (Intercept)  2.97251   0.123616 24.04627 < 2.2e-16 ***
## ivb          1.04052   0.393077  2.64712  0.010948 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.486572   Adj. R2: 0.109208
## F-test (1st stage): stat = 7.00725, p = 0.010948, on 1 and 48 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivb
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|) 
## (Intercept)           -1.150851   1.250540 -0.920283  0.36203 
## fit_`Avg Shelf Price` -0.542571   0.385122 -1.408829  0.16533 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.496043   Adj. R2: -0.015443
## F-test (1st stage), `Avg Shelf Price`: stat = 7.00725 , p = 0.010948, on 1 and 48 DoF.
##                            Wu-Hausman: stat = 0.591994, p = 0.445499, on 1 and 47 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv3c\_3 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivc, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivc
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##             Estimate Std. Error  t value Pr(>|t|)    
## (Intercept)  2.87332   1.675058 1.715355  0.09273 .  
## ivc          0.12097   0.549358 0.220202  0.82665    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.520616   Adj. R2: -0.019803
## F-test (1st stage): stat = 0.048489, p = 0.826648, on 1 and 48 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivc
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                       Estimate Std. Error   t value Pr(>|t|) 
## (Intercept)            37.2370   178.8588  0.208192  0.83596 
## fit_`Avg Shelf Price` -12.3841    55.1720 -0.224464  0.82335 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 6.32495   Adj. R2: -164.1
## F-test (1st stage), `Avg Shelf Price`: stat =  0.048489, p = 0.826648, on 1 and 48 DoF.
##                            Wu-Hausman: stat = 10.1     , p = 0.002594, on 1 and 47 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(ols2\_2 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{|}\NormalTok{fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## Cals               0.001039   0.002683  0.387330 0.7005651    
## Fat                0.015549   0.059908  0.259545 0.7965463    
## Sugar             -0.037275   0.014459 -2.577907 0.0137295 *  
## `Avg Shelf Price` -0.443217   0.154931 -2.860740 0.0066887 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391354     Adj. R2: 0.241534
##                  Within R2: 0.314077
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv3c\_4 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ fbrand }\SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ iva, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##              Estimate Std. Error   t value   Pr(>|t|)    
## (Intercept)  28.47947   2.612066  10.90304 5.8672e-14 ***
## iva          -7.52683   0.787228  -9.56118 3.3100e-12 ***
## fbrandKG     -2.62944   0.258271 -10.18094 4.9949e-13 ***
## fbrandNB    -10.22521   1.032761  -9.90085 1.1671e-12 ***
## fbrandPT     -5.93515   0.591083 -10.04114 7.6199e-13 ***
## fbrandQK    -12.04940   1.160840 -10.37990 2.7501e-13 ***
## fbrandRL    -11.99805   1.265029  -9.48440 4.1978e-12 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.246575   Adj. R2: 0.744641
## F-test (1st stage): stat = 91.4, p = 3.31e-12, on 1 and 43 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)           -1.529325   0.645172 -2.370414 0.022322 *  
## fit_`Avg Shelf Price` -0.397083   0.181077 -2.192897 0.033772 *  
## fbrandKG               0.075634   0.165779  0.456233 0.650519    
## fbrandNB              -0.277851   0.299881 -0.926539 0.359338    
## fbrandPT              -0.338672   0.229483 -1.475803 0.147283    
## fbrandQK              -0.660875   0.316536 -2.087831 0.042773 *  
## fbrandRL              -0.217531   0.343244 -0.633751 0.529600    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.426897   Adj. R2: 0.160471
## F-test (1st stage), `Avg Shelf Price`: stat = 91.4     , p = 3.31e-12, on 1 and 43 DoF.
##                            Wu-Hausman: stat =  0.510646, p = 0.478813, on 1 and 42 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv3c\_5 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ fbrand }\SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivb, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivb
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##              Estimate Std. Error   t value   Pr(>|t|)    
## (Intercept)  3.209507   0.158976 20.188664  < 2.2e-16 ***
## ivb          0.934626   0.372589  2.508460 0.01597731 *  
## fbrandKG    -0.203184   0.154991 -1.310935 0.19683784    
## fbrandNB    -0.388022   0.276195 -1.404887 0.16723811    
## fbrandPT    -0.400799   0.207030 -1.935944 0.05946620 .  
## fbrandQK    -0.947298   0.245487 -3.858860 0.00037712 ***
## fbrandRL     0.166376   0.338668  0.491267 0.62573615    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.407178   Adj. R2: 0.303658
## F-test (1st stage): stat = 6.29237, p = 0.015977, on 1 and 43 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivb
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)           -0.841391   1.479322 -0.568768 0.572473    
## fit_`Avg Shelf Price` -0.592952   0.420047 -1.411634 0.165253    
## fbrandKG               0.014018   0.204795  0.068450 0.945744    
## fbrandNB              -0.371650   0.351708 -1.056702 0.296548    
## fbrandPT              -0.419413   0.278468 -1.506143 0.139342    
## fbrandQK              -0.864524   0.506096 -1.708219 0.094806 .  
## fbrandRL              -0.227760   0.345526 -0.659169 0.513302    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.429031   Adj. R2: 0.152056
## F-test (1st stage), `Avg Shelf Price`: stat = 6.29237 , p = 0.015977, on 1 and 43 DoF.
##                            Wu-Hausman: stat = 0.096901, p = 0.75712 , on 1 and 42 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv3c\_6 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ fbrand }\SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivc, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                     \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivc
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##              Estimate Std. Error   t value   Pr(>|t|)    
## (Intercept)  0.767455   1.547280  0.496003 6.2242e-01    
## ivc          0.907144   0.510152  1.778184 8.2445e-02 .  
## fbrandKG    -0.298941   0.153698 -1.944989 5.8334e-02 .  
## fbrandNB    -0.524014   0.284077 -1.844622 7.1988e-02 .  
## fbrandPT    -0.470493   0.216379 -2.174394 3.5224e-02 *  
## fbrandQK    -1.200621   0.266624 -4.503052 5.0578e-05 ***
## fbrandRL    -0.081865   0.338590 -0.241783 8.1010e-01    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.420758   Adj. R2: 0.256436
## F-test (1st stage): stat = 3.16194, p = 0.082445, on 1 and 43 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : ivc
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)            2.259418   2.872371  0.786604 0.435828    
## fit_`Avg Shelf Price` -1.475814   0.816625 -1.807211 0.077729 .  
## fbrandKG              -0.263708   0.340061 -0.775473 0.442304    
## fbrandNB              -0.794443   0.567226 -1.400577 0.168516    
## fbrandPT              -0.783349   0.458019 -1.710296 0.094418 .  
## fbrandQK              -1.782455   0.923874 -1.929327 0.060306 .  
## fbrandRL              -0.273865   0.492921 -0.555596 0.581367    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.610986   Adj. R2: -0.719698
## F-test (1st stage), `Avg Shelf Price`: stat = 3.16194, p = 0.082445, on 1 and 43 DoF.
##                            Wu-Hausman: stat = 3.55038, p = 0.066466, on 1 and 42 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gof }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{raw =} \FunctionTok{c}\NormalTok{(}\StringTok{"nobs"}\NormalTok{, }\StringTok{"adj.r.squared"}\NormalTok{),}
                  \AttributeTok{clean =} \FunctionTok{c}\NormalTok{(}\StringTok{"Observations"}\NormalTok{, }\StringTok{"R2 adj."}\NormalTok{),}
                  \AttributeTok{fmt =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{3}\NormalTok{))}
\NormalTok{fe }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{FE =} \FunctionTok{c}\NormalTok{(}\StringTok{"Brand FE"}\NormalTok{, }\StringTok{"Instruments"}\NormalTok{),}
                 \AttributeTok{mod1 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"None"}\NormalTok{),}
                 \AttributeTok{mod2 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"IVA"}\NormalTok{),}
                 \AttributeTok{mod3 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"IVB"}\NormalTok{),}
                 \AttributeTok{mod4 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"IVC"}\NormalTok{),}
                \AttributeTok{mod5 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"None"}\NormalTok{),}
                \AttributeTok{mod6 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"IVA"}\NormalTok{),}
                \AttributeTok{mod7 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"IVB"}\NormalTok{),}
                \AttributeTok{mod8 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"IVC"}\NormalTok{))}

\FunctionTok{attr}\NormalTok{(fe, }\StringTok{"position"}\NormalTok{) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{23}\NormalTok{, }\DecValTok{24}\NormalTok{)}

\FunctionTok{modelsummary}\NormalTok{(}\FunctionTok{list}\NormalTok{(ols2\_1, iv3c\_1,iv3c\_2,iv3c\_3, ols2\_2,iv3c\_4,iv3c\_5,iv3c\_6),}
              \AttributeTok{stars =} \FunctionTok{c}\NormalTok{(}\StringTok{"*"} \OtherTok{=}\NormalTok{ .}\DecValTok{1}\NormalTok{, }\StringTok{"**"} \OtherTok{=}\NormalTok{ .}\DecValTok{05}\NormalTok{, }\StringTok{"***"} \OtherTok{=}\NormalTok{ .}\DecValTok{01}\NormalTok{),}
              \AttributeTok{gof\_map =}\NormalTok{ gof, }\AttributeTok{add\_rows =}\NormalTok{ fe, }\AttributeTok{output =} \StringTok{"markdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{talltblr}[         %% tabularray outer open
entry=none,label=none,
note{}={* p < 0.1, ** p < 0.05, *** p < 0.01},
]                     %% tabularray outer close
{                     %% tabularray inner open
colspec={Q[]Q[]Q[]Q[]Q[]Q[]Q[]Q[]Q[]},
column{1}={halign=l,},
column{2}={halign=c,},
column{3}={halign=c,},
column{4}={halign=c,},
column{5}={halign=c,},
column{6}={halign=c,},
column{7}={halign=c,},
column{8}={halign=c,},
column{9}={halign=c,},
hline{24}={1,2,3,4,5,6,7,8,9}{solid, 0.05em, black},
}                     %% tabularray inner close
\toprule
& (1) & (2) & (3) & (4) & (5) & (6) & (7) & (8) \\ \midrule %% TinyTableHeader
(Intercept)         & -1.762*** & -4.876*** & -1.151  & 37.237    &           & -1.529** & -0.841  & 2.259   \\
& (0.610)   & (1.741)   & (1.251) & (178.859) &           & (0.645)  & (1.479) & (2.872) \\
Cals                & 0.000     &           &         &           & 0.001     &          &         &         \\
& (0.002)   &           &         &           & (0.003)   &          &         &         \\
Fat                 & -0.001    &           &         &           & 0.016     &          &         &         \\
& (0.057)   &           &         &           & (0.060)   &          &         &         \\
Sugar               & -0.028**  &           &         &           & -0.037**  &          &         &         \\
& (0.014)   &           &         &           & (0.014)   &          &         &         \\
Avg Shelf Price     & -0.268*   &           &         &           & -0.443*** &          &         &         \\
& (0.138)   &           &         &           & (0.155)   &          &         &         \\
fit_Avg Shelf Price &           & 0.607     & -0.543  & -12.384   &           & -0.397** & -0.593  & -1.476* \\
&           & (0.536)   & (0.385) & (55.172)  &           & (0.181)  & (0.420) & (0.817) \\
fbrandKG            &           &           &         &           &           & 0.076    & 0.014   & -0.264  \\
&           &           &         &           &           & (0.166)  & (0.205) & (0.340) \\
fbrandNB            &           &           &         &           &           & -0.278   & -0.372  & -0.794  \\
&           &           &         &           &           & (0.300)  & (0.352) & (0.567) \\
fbrandPT            &           &           &         &           &           & -0.339   & -0.419  & -0.783* \\
&           &           &         &           &           & (0.229)  & (0.278) & (0.458) \\
fbrandQK            &           &           &         &           &           & -0.661** & -0.865* & -1.782* \\
&           &           &         &           &           & (0.317)  & (0.506) & (0.924) \\
fbrandRL            &           &           &         &           &           & -0.218   & -0.228  & -0.274  \\
&           &           &         &           &           & (0.343)  & (0.346) & (0.493) \\
Brand FE            & No        & No        & No      & No        & Yes       & Yes      & Yes     & Yes     \\
Instruments         & None      & IVA       & IVB     & IVC       & None      & IVA      & IVB     & IVC     \\
Observations        & 50        & 50        & 50      & 50        & 50        & 50       & 50      & 50      \\
R2 adj.             & 0.102     & -0.807    & -0.015  & -164.094  & 0.242     & 0.160    & 0.152   & -0.720  \\
\bottomrule
\end{talltblr}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv3c\_1, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 6.36046 , p = 0.015041, on 1 and 48 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 6.36046 , p = 0.015041, on 1 and 48 DoF.
##                       Kleibergen-Paap: stat = 0.936985, p = 0.333055, on 1 DoF.
##                                Sargan: NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv3c\_2, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 7.00725, p = 0.010948, on 1 and 48 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 7.00725, p = 0.010948, on 1 and 48 DoF.
##                       Kleibergen-Paap: stat = 1.03227, p = 0.309627, on 1 DoF.
##                                Sargan: NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv3c\_3, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 0.048489, p = 0.826648, on 1 and 48 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 0.048489, p = 0.826648, on 1 and 48 DoF.
##                       Kleibergen-Paap: stat = 0.007143, p = 0.932646, on 1 DoF.
##                                Sargan: NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv3c\_4, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 91.4, p = 3.31e-12, on 1 and 43 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 91.4, p = 3.31e-12, on 1 and 43 DoF.
##                       Kleibergen-Paap: stat = 15.0, p = 1.057e-4, on 1 DoF.
##                                Sargan: NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv3c\_5, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 6.29237, p = 0.015977, on 1 and 43 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 6.29237, p = 0.015977, on 1 and 43 DoF.
##                       Kleibergen-Paap: stat = 1.03474, p = 0.309048, on 1 DoF.
##                                Sargan: NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv3c\_6, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 3.16194, p = 0.082445, on 1 and 43 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 3.16194, p = 0.082445, on 1 and 43 DoF.
##                       Kleibergen-Paap: stat = 0.51996, p = 0.470859, on 1 DoF.
##                                Sargan: NA
\end{verbatim}

\#interaction

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(ols2\_1 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }
                        \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)       -1.761605   0.609939 -2.888166 0.0059381 ** 
## Cals               0.000043   0.002495  0.017160 0.9863846    
## Fat               -0.000561   0.056523 -0.009931 0.9921202    
## Sugar             -0.028234   0.014011 -2.015177 0.0498831 *  
## `Avg Shelf Price` -0.267781   0.138457 -1.934033 0.0594128 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451604   Adj. R2: 0.102238
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv4c\_1 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ iva }\SpecialCharTok{+}\NormalTok{  ivb }\SpecialCharTok{+}\NormalTok{ ivc, }
                        \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva, ivb, ivc
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##              Estimate Std. Error   t value Pr(>|t|)    
## (Intercept) -0.239607   1.745159 -0.137298 0.891395    
## iva          0.349348   0.136923  2.551422 0.014118 *  
## ivb          0.960373   0.381827  2.515205 0.015453 *  
## ivc          0.732597   0.517776  1.414891 0.163834    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.453336   Adj. R2: 0.193128
## F-test (1st stage): stat = 4.90945, p = 0.004831, on 3 and 46 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva, ivb, ivc
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error  t value Pr(>|t|)    
## (Intercept)           -2.009077   0.871299 -2.30584 0.025484 *  
## fit_`Avg Shelf Price` -0.277834   0.267933 -1.03695 0.304954    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.476173   Adj. R2: 0.064282
## F-test (1st stage), `Avg Shelf Price`: stat =  4.90945 , p = 0.004831, on 3 and 46 DoF.
##                            Wu-Hausman: stat =  8.026e-5, p = 0.99289 , on 1 and 47 DoF.
##                                Sargan: stat = 13.0     , p = 0.001471, on 2 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(ols2\_2 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{|}\NormalTok{fbrand, }
                        \AttributeTok{data =}\NormalTok{ cerealdata,}\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## Cals               0.001039   0.002683  0.387330 0.7005651    
## Fat                0.015549   0.059908  0.259545 0.7965463    
## Sugar             -0.037275   0.014459 -2.577907 0.0137295 *  
## `Avg Shelf Price` -0.443217   0.154931 -2.860740 0.0066887 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391354     Adj. R2: 0.241534
##                  Within R2: 0.314077
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv4c\_2 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ fbrand }\SpecialCharTok{|}  \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{ iva }\SpecialCharTok{+}\NormalTok{ ivb }\SpecialCharTok{+}\NormalTok{ivc, }
                        \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{),}\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva, ivb, ivc
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##               Estimate Std. Error  t value   Pr(>|t|)    
## (Intercept)  24.334543   3.092922  7.86782 1.0096e-09 ***
## iva          -6.898562   0.825861 -8.35317 2.1802e-10 ***
## ivb           0.335141   0.238589  1.40468 1.6765e-01    
## ivc           0.645248   0.298977  2.15819 3.6821e-02 *  
## fbrandKG     -2.385154   0.280972 -8.48894 1.4263e-10 ***
## fbrandNB     -9.411189   1.087122 -8.65697 8.4593e-11 ***
## fbrandPT     -5.511500   0.615284 -8.95766 3.3486e-11 ***
## fbrandQK    -11.211718   1.215269 -9.22571 1.4790e-11 ***
## fbrandRL    -10.943620   1.344465 -8.13976 4.2648e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.231579   Adj. R2: 0.76377
## F-test (1st stage): stat = 34.8, p = 2.419e-11, on 3 and 41 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva, ivb, ivc
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)           -1.228301   0.626763 -1.959754 0.0565265 .  
## fit_`Avg Shelf Price` -0.482791   0.175772 -2.746682 0.0087573 ** 
## fbrandKG               0.048672   0.164812  0.295320 0.7691707    
## fbrandNB              -0.318895   0.298403 -1.068674 0.2911795    
## fbrandPT              -0.374002   0.228218 -1.638790 0.1085544    
## fbrandQK              -0.749987   0.312723 -2.398249 0.0208848 *  
## fbrandRL              -0.222007   0.342299 -0.648577 0.5200606    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.42573   Adj. R2: 0.165055
## F-test (1st stage), `Avg Shelf Price`: stat = 34.8     , p = 2.419e-11, on 3 and 41 DoF.
##                            Wu-Hausman: stat =  0.016982, p = 0.896941 , on 1 and 42 DoF.
##                                Sargan: stat =  5.12687 , p = 0.07704  , on 2 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gof }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{raw =} \FunctionTok{c}\NormalTok{(}\StringTok{"nobs"}\NormalTok{, }\StringTok{"adj.r.squared"}\NormalTok{),}
                  \AttributeTok{clean =} \FunctionTok{c}\NormalTok{(}\StringTok{"Observations"}\NormalTok{, }\StringTok{"R2 adj."}\NormalTok{),}
                  \AttributeTok{fmt =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{3}\NormalTok{))}
\NormalTok{fe }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{FE =} \FunctionTok{c}\NormalTok{(}\StringTok{"Brand FE"}\NormalTok{, }\StringTok{"Instruments"}\NormalTok{),}
                 \AttributeTok{mod1 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"None"}\NormalTok{),}
                 \AttributeTok{mod2 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"IVA+IVB+IVC"}\NormalTok{),}
                 \AttributeTok{mod3 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"None"}\NormalTok{),}
                 \AttributeTok{mod4 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"IVA+IVB+IVC"}\NormalTok{))}

\FunctionTok{attr}\NormalTok{(fe, }\StringTok{"position"}\NormalTok{) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{23}\NormalTok{, }\DecValTok{24}\NormalTok{)}

\FunctionTok{modelsummary}\NormalTok{(}\FunctionTok{list}\NormalTok{(ols2\_1, iv4c\_1, ols2\_2, iv4c\_2),}
              \AttributeTok{stars =} \FunctionTok{c}\NormalTok{(}\StringTok{"*"} \OtherTok{=}\NormalTok{ .}\DecValTok{1}\NormalTok{, }\StringTok{"**"} \OtherTok{=}\NormalTok{ .}\DecValTok{05}\NormalTok{, }\StringTok{"***"} \OtherTok{=}\NormalTok{ .}\DecValTok{01}\NormalTok{),}
              \AttributeTok{gof\_map =}\NormalTok{ gof, }\AttributeTok{add\_rows =}\NormalTok{ fe, }\AttributeTok{output =} \StringTok{"markdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{talltblr}[         %% tabularray outer open
entry=none,label=none,
note{}={* p < 0.1, ** p < 0.05, *** p < 0.01},
]                     %% tabularray outer close
{                     %% tabularray inner open
colspec={Q[]Q[]Q[]Q[]Q[]},
column{1}={halign=l,},
column{2}={halign=c,},
column{3}={halign=c,},
column{4}={halign=c,},
column{5}={halign=c,},
hline{24}={1,2,3,4,5}{solid, 0.05em, black},
}                     %% tabularray inner close
\toprule
& (1) & (2) & (3) & (4) \\ \midrule %% TinyTableHeader
(Intercept)         & -1.762*** & -2.009**    &           & -1.228*     \\
& (0.610)   & (0.871)     &           & (0.627)     \\
Cals                & 0.000     &             & 0.001     &             \\
& (0.002)   &             & (0.003)   &             \\
Fat                 & -0.001    &             & 0.016     &             \\
& (0.057)   &             & (0.060)   &             \\
Sugar               & -0.028**  &             & -0.037**  &             \\
& (0.014)   &             & (0.014)   &             \\
Avg Shelf Price     & -0.268*   &             & -0.443*** &             \\
& (0.138)   &             & (0.155)   &             \\
fit_Avg Shelf Price &           & -0.278      &           & -0.483***   \\
&           & (0.268)     &           & (0.176)     \\
fbrandKG            &           &             &           & 0.049       \\
&           &             &           & (0.165)     \\
fbrandNB            &           &             &           & -0.319      \\
&           &             &           & (0.298)     \\
fbrandPT            &           &             &           & -0.374      \\
&           &             &           & (0.228)     \\
fbrandQK            &           &             &           & -0.750**    \\
&           &             &           & (0.313)     \\
fbrandRL            &           &             &           & -0.222      \\
&           &             &           & (0.342)     \\
Brand FE            & No        & No          & Yes       & Yes         \\
Instruments         & None      & IVA+IVB+IVC & None      & IVA+IVB+IVC \\
Observations        & 50        & 50          & 50        & 50          \\
R2 adj.             & 0.102     & 0.064       & 0.242     & 0.165       \\
\bottomrule
\end{talltblr}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv4c\_1, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat =  4.90945 , p = 0.004831, on 3 and 46 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat =  4.90945 , p = 0.004831, on 3 and 46 DoF.
##                       Kleibergen-Paap: stat =  0.754674, p = 0.860275, on 3 DoF.
##                                Sargan: stat = 13.0     , p = 0.001471, on 2 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fitstat}\NormalTok{(iv4c\_2, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ivwald1 }\SpecialCharTok{+}\NormalTok{ ivf1 }\SpecialCharTok{+}\NormalTok{ kpr }\SpecialCharTok{+}\NormalTok{ sargan)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald (1st stage), `Avg Shelf Price`  : stat = 34.8    , p = 2.419e-11, on 3 and 41 DoF, VCOV: IID.
## F-test (1st stage), `Avg Shelf Price`: stat = 34.8    , p = 2.419e-11, on 3 and 41 DoF.
##                       Kleibergen-Paap: stat =  5.99605, p = 0.111803 , on 3 DoF.
##                                Sargan: stat =  5.12687, p = 0.07704  , on 2 DoF.
\end{verbatim}

\section{TASK 5}\label{task-5}

\textbf{Thinking out of the matrix. In case you didn't get a
satisfactory specification up to now, can you suggest any improvements?
Hint: One improvement comes from a new variable. Another improvement
comes from tackling the IIA property of logit models. As a guidance,
When reporting, please include again the following specifications
previously reported: (i) your preferred OLS logit specifications with
and without brand FEs; (ii) your preferred IV logit specification with
and without brand FEs which include all instruments.}

The ``IIA property'' refers to the Independence of Irrelevant
Alternatives, which is a key assumption in multinomial logit models.
This assumption states that the odds of choosing one alternative over
another are unaffected by the presence or absence of other alternatives
in the choice set.

However, the IIA property is often criticized because it can lead to
unrealistic modeling assumptions. When the IIA property is violated, it
implies that the relative attractiveness of alternatives is influenced
by the inclusion or exclusion of irrelevant alternatives in the choice
set. This can result in biased model estimates and misleading
predictions.

There are several techniques to address or mitigate violations of the
IIA property:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Nested Logit Models}: These models relax the assumption of
  independence by allowing for correlation within subsets of
  alternatives. Alternatives are grouped into nested subsets based on
  similarities or shared characteristics. This allows for more
  flexibility in capturing heterogeneity in preferences.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create dummy variable for sugar}
\NormalTok{cerealdata}\SpecialCharTok{$}\NormalTok{sugar\_dummy }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{Sugar }\SpecialCharTok{\textgreater{}=} \DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\CommentTok{\#withouth brand fix effect baseline model}
\NormalTok{ols\_1o }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_1o)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)       -1.761605   0.609939 -2.888166 0.0059381 ** 
## Cals               0.000043   0.002495  0.017160 0.9863846    
## Fat               -0.000561   0.056523 -0.009931 0.9921202    
## Sugar             -0.028234   0.014011 -2.015177 0.0498831 *  
## `Avg Shelf Price` -0.267781   0.138457 -1.934033 0.0594128 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.451604   Adj. R2: 0.102238
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#new variable}
\NormalTok{ols\_1n }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{+}\NormalTok{ sugar\_dummy, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_1n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## (Intercept)       -2.170164   0.682546 -3.179515 0.0027014 ** 
## Cals               0.000912   0.002566  0.355400 0.7239884    
## Fat               -0.012351   0.056834 -0.217320 0.8289633    
## Sugar             -0.038819   0.016127 -2.407061 0.0203443 *  
## `Avg Shelf Price` -0.267059   0.137425 -1.943311 0.0583928 .  
## sugar_dummy        0.431503   0.332946  1.296014 0.2017279    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.443224   Adj. R2: 0.115595
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#with brand fix effect baseline model}
\NormalTok{ols\_4o }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{|}\NormalTok{ fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_4o)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## Cals               0.001039   0.002683  0.387330 0.7005651    
## Fat                0.015549   0.059908  0.259545 0.7965463    
## Sugar             -0.037275   0.014459 -2.577907 0.0137295 *  
## `Avg Shelf Price` -0.443217   0.154931 -2.860740 0.0066887 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391354     Adj. R2: 0.241534
##                  Within R2: 0.314077
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#new variable}
\NormalTok{ols\_4n }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{+}\NormalTok{ sugar\_dummy }\SpecialCharTok{|}\NormalTok{ fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata,}
                \AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(ols\_4n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                    Estimate Std. Error   t value  Pr(>|t|)    
## Cals               0.001226   0.002699  0.454116 0.6522628    
## Fat                0.015201   0.060092  0.252968 0.8016217    
## Sugar             -0.042151   0.015548 -2.711013 0.0099219 ** 
## `Avg Shelf Price` -0.442477   0.155405 -2.847250 0.0069996 ** 
## sugar_dummy        0.324738   0.373145  0.870275 0.3894755    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.387608     Adj. R2: 0.236905
##                  Within R2: 0.327144
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# without fe  iv1a\_2 Average advert Expenditure*brand }

\FunctionTok{summary}\NormalTok{(iv1a\_2o }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Ad Expn}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Ad Expn`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)           -0.478423   1.173293 -0.407761 0.685383    
## fit_`Avg Shelf Price` -0.597983   0.291552 -2.051032 0.046113 *  
## Cals                  -0.001983   0.003066 -0.646822 0.521033    
## Fat                    0.017643   0.061574  0.286537 0.775782    
## Sugar                 -0.022990   0.015398 -1.493041 0.142405    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.479295   Adj. R2: -0.01123
## F-test (1st stage), `Avg Shelf Price`: stat =  2.27027, p = 0.055895, on 6 and 40 DoF.
##                            Wu-Hausman: stat =  1.97898, p = 0.166522, on 1 and 44 DoF.
##                                Sargan: stat = 29.9    , p = 1.567e-5, on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#without fe  iv1a\_2 Average advert Expenditure*brand }
\FunctionTok{summary}\NormalTok{(iv1a\_2n }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+}\NormalTok{ sugar\_dummy }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Ad Expn}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Ad Expn`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)           -0.814535   1.219810 -0.667755 0.507777    
## fit_`Avg Shelf Price` -0.615076   0.290728 -2.115642 0.040071 *  
## Cals                  -0.001230   0.003150 -0.390498 0.698053    
## Fat                    0.006929   0.062401  0.111037 0.912092    
## Sugar                 -0.033208   0.017729 -1.873038 0.067716 .  
## sugar_dummy            0.428083   0.356394  1.201152 0.236118    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.474426   Adj. R2: -0.01331
## F-test (1st stage), `Avg Shelf Price`: stat =  2.23661, p = 0.059767, on 6 and 39 DoF.
##                            Wu-Hausman: stat =  2.27044, p = 0.139174, on 1 and 43 DoF.
##                                Sargan: stat = 29.5    , p = 1.83e-5 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# with fe  iv1a\_6 Average transaction price*brand }

\FunctionTok{summary}\NormalTok{(iv2a\_6o }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{|}\NormalTok{ fbrand }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }
                        \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Trans Price`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## fit_`Avg Shelf Price` -0.409198   0.169093 -2.419955 0.020159 *  
## Cals                   0.001275   0.002725  0.467916 0.642384    
## Fat                    0.011934   0.060372  0.197672 0.844303    
## Sugar                 -0.037855   0.014514 -2.608192 0.012736 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391589     Adj. R2: 0.24062
##                  Within R2: 0.31325
## F-test (1st stage), `Avg Shelf Price`: stat = 30.7     , p = 1.451e-12, on 6 and 35 DoF.
##                            Wu-Hausman: stat =  0.249329, p = 0.620353 , on 1 and 39 DoF.
##                                Sargan: stat =  9.92037 , p = 0.077523 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# with fe  iv1a\_6 Average transaction price*brand }

\FunctionTok{summary}\NormalTok{(iv2a\_6n }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Cals }\SpecialCharTok{+}\NormalTok{ Fat }\SpecialCharTok{+}\NormalTok{ Sugar }\SpecialCharTok{+}\NormalTok{sugar\_dummy}\SpecialCharTok{|}\NormalTok{ fbrand }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Avg Trans Price}\StringTok{\textasciigrave{}}\SpecialCharTok{:}\NormalTok{fbrand, }
                        \AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Trans Price`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                        Estimate Std. Error   t value  Pr(>|t|)    
## fit_`Avg Shelf Price` -0.409329   0.169602 -2.413474 0.0205978 *  
## Cals                   0.001456   0.002741  0.531064 0.5983862    
## Fat                    0.011679   0.060556  0.192856 0.8480729    
## Sugar                 -0.042723   0.015601 -2.738469 0.0092547 ** 
## sugar_dummy            0.325173   0.373363  0.870931 0.3891216    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.387834     Adj. R2: 0.236015
##                  Within R2: 0.326359
## F-test (1st stage), `Avg Shelf Price`: stat = 29.9     , p = 3.426e-12, on 6 and 34 DoF.
##                            Wu-Hausman: stat =  0.235177, p = 0.630496 , on 1 and 38 DoF.
##                                Sargan: stat =  9.76204 , p = 0.082265 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gof }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{raw =} \FunctionTok{c}\NormalTok{(}\StringTok{"nobs"}\NormalTok{, }\StringTok{"adj.r.squared"}\NormalTok{),}
                  \AttributeTok{clean =} \FunctionTok{c}\NormalTok{(}\StringTok{"Observations"}\NormalTok{, }\StringTok{"R2 adj."}\NormalTok{),}
                  \AttributeTok{fmt =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{3}\NormalTok{))}
\NormalTok{fe }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{FE =} \FunctionTok{c}\NormalTok{(}\StringTok{"Brand FE"}\NormalTok{, }\StringTok{"Instruments"}\NormalTok{,}\StringTok{"New variable"}\NormalTok{),}
                 \AttributeTok{mod1 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"None"}\NormalTok{,}\StringTok{"No"}\NormalTok{),}
                 \AttributeTok{mod2 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"None"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{),}
                 \AttributeTok{mod3 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"None"}\NormalTok{,}\StringTok{"No"}\NormalTok{),}
                 \AttributeTok{mod4 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"None"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{),}
                 \AttributeTok{mod5 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"Average advert Expenditure*brand"}\NormalTok{,}\StringTok{"No"}\NormalTok{),}
                 \AttributeTok{mod6 =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"Average advert Expenditure*brand"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{),}
                 \AttributeTok{mod7 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"Average Avg Trans Price*brand"}\NormalTok{,}\StringTok{"No"}\NormalTok{),}
                 \AttributeTok{mod8 =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"Average Avg Trans Price*brand"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{))}
                 

\FunctionTok{attr}\NormalTok{(fe, }\StringTok{"position"}\NormalTok{) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{16}\NormalTok{)}

\FunctionTok{modelsummary}\NormalTok{(}\FunctionTok{list}\NormalTok{(ols\_1o, ols\_1n, ols\_4o, ols\_4n, iv1a\_2o, iv1a\_2n, iv2a\_6o, iv2a\_6n),}
              \AttributeTok{stars =} \FunctionTok{c}\NormalTok{(}\StringTok{"*"} \OtherTok{=}\NormalTok{ .}\DecValTok{1}\NormalTok{, }\StringTok{"**"} \OtherTok{=}\NormalTok{ .}\DecValTok{05}\NormalTok{, }\StringTok{"***"} \OtherTok{=}\NormalTok{ .}\DecValTok{01}\NormalTok{),}
              \AttributeTok{gof\_map =}\NormalTok{ gof, }\AttributeTok{add\_rows =}\NormalTok{ fe, }\AttributeTok{output =} \StringTok{"markdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{talltblr}[         %% tabularray outer open
entry=none,label=none,
note{}={* p < 0.1, ** p < 0.05, *** p < 0.01},
]                     %% tabularray outer close
{                     %% tabularray inner open
colspec={Q[]Q[]Q[]Q[]Q[]Q[]Q[]Q[]Q[]},
column{1}={halign=l,},
column{2}={halign=c,},
column{3}={halign=c,},
column{4}={halign=c,},
column{5}={halign=c,},
column{6}={halign=c,},
column{7}={halign=c,},
column{8}={halign=c,},
column{9}={halign=c,},
hline{16}={1,2,3,4,5,6,7,8,9}{solid, 0.05em, black},
}                     %% tabularray inner close
\toprule
& (1) & (2) & (3) & (4) & (5) & (6) & (7) & (8) \\ \midrule %% TinyTableHeader
(Intercept)         & -1.762*** & -2.170*** &           &           & -0.478                           & -0.815                           &                               &                               \\
& (0.610)   & (0.683)   &           &           & (1.173)                          & (1.220)                          &                               &                               \\
Cals                & 0.000     & 0.001     & 0.001     & 0.001     & -0.002                           & -0.001                           & 0.001                         & 0.001                         \\
& (0.002)   & (0.003)   & (0.003)   & (0.003)   & (0.003)                          & (0.003)                          & (0.003)                       & (0.003)                       \\
Fat                 & -0.001    & -0.012    & 0.016     & 0.015     & 0.018                            & 0.007                            & 0.012                         & 0.012                         \\
& (0.057)   & (0.057)   & (0.060)   & (0.060)   & (0.062)                          & (0.062)                          & (0.060)                       & (0.061)                       \\
Sugar               & -0.028**  & -0.039**  & -0.037**  & -0.042*** & -0.023                           & -0.033*                          & -0.038**                      & -0.043***                     \\
& (0.014)   & (0.016)   & (0.014)   & (0.016)   & (0.015)                          & (0.018)                          & (0.015)                       & (0.016)                       \\
Avg Shelf Price     & -0.268*   & -0.267*   & -0.443*** & -0.442*** &                                  &                                  &                               &                               \\
& (0.138)   & (0.137)   & (0.155)   & (0.155)   &                                  &                                  &                               &                               \\
sugar_dummy         &           & 0.432     &           & 0.325     &                                  & 0.428                            &                               & 0.325                         \\
&           & (0.333)   &           & (0.373)   &                                  & (0.356)                          &                               & (0.373)                       \\
fit_Avg Shelf Price &           &           &           &           & -0.598**                         & -0.615**                         & -0.409**                      & -0.409**                      \\
&           &           &           &           & (0.292)                          & (0.291)                          & (0.169)                       & (0.170)                       \\
Brand FE            & No        & No        & Yes       & Yes       & No                               & No                               & Yes                           & Yes                           \\
Instruments         & None      & None      & None      & None      & Average advert Expenditure*brand & Average advert Expenditure*brand & Average Avg Trans Price*brand & Average Avg Trans Price*brand \\
Observations        & 50        & 50        & 50        & 50        & 50                               & 50                               & 50                            & 50                            \\
R2 adj.             & 0.102     & 0.116     & 0.242     & 0.237     & -0.011                           & -0.013                           & 0.241                         & 0.236                         \\
New variable        & No        & Yes       & No        & Yes       & No                               & Yes                              & No                            & Yes                           \\
\bottomrule
\end{talltblr}
\end{table}

\#\#\#QUESTION6

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv5 }\OtherTok{\textless{}{-}} \FunctionTok{feols}\NormalTok{(mean\_utility }\SpecialCharTok{\textasciitilde{}}\NormalTok{ fbrand }\SpecialCharTok{|} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}}\NormalTok{ iva, }\AttributeTok{data =}\NormalTok{ cerealdata, }\AttributeTok{se =} \StringTok{\textquotesingle{}iid\textquotesingle{}}\NormalTok{), }\AttributeTok{stage =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## IV: First stage: `Avg Shelf Price`
## TSLS estimation - Dep. Var.: `Avg Shelf Price`
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva
## First stage: Dep. Var.: `Avg Shelf Price`
## Observations: 50
## Standard-errors: IID 
##              Estimate Std. Error   t value   Pr(>|t|)    
## (Intercept)  28.47947   2.612066  10.90304 5.8672e-14 ***
## iva          -7.52683   0.787228  -9.56118 3.3100e-12 ***
## fbrandKG     -2.62944   0.258271 -10.18094 4.9949e-13 ***
## fbrandNB    -10.22521   1.032761  -9.90085 1.1671e-12 ***
## fbrandPT     -5.93515   0.591083 -10.04114 7.6199e-13 ***
## fbrandQK    -12.04940   1.160840 -10.37990 2.7501e-13 ***
## fbrandRL    -11.99805   1.265029  -9.48440 4.1978e-12 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.246575   Adj. R2: 0.744641
## F-test (1st stage): stat = 91.4, p = 3.31e-12, on 1 and 43 DoF.
## 
## IV: Second stage
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : iva
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## (Intercept)           -1.529325   0.645172 -2.370414 0.022322 *  
## fit_`Avg Shelf Price` -0.397083   0.181077 -2.192897 0.033772 *  
## fbrandKG               0.075634   0.165779  0.456233 0.650519    
## fbrandNB              -0.277851   0.299881 -0.926539 0.359338    
## fbrandPT              -0.338672   0.229483 -1.475803 0.147283    
## fbrandQK              -0.660875   0.316536 -2.087831 0.042773 *  
## fbrandRL              -0.217531   0.343244 -0.633751 0.529600    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.426897   Adj. R2: 0.160471
## F-test (1st stage), `Avg Shelf Price`: stat = 91.4     , p = 3.31e-12, on 1 and 43 DoF.
##                            Wu-Hausman: stat =  0.510646, p = 0.478813, on 1 and 42 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{elas }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(}\FunctionTok{aggregate}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{mean\_utility, }\FunctionTok{list}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{fbrand), }\AttributeTok{FUN =}\NormalTok{ mean),}
              \FunctionTok{aggregate}\NormalTok{(cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\FunctionTok{list}\NormalTok{(cerealdata}\SpecialCharTok{$}\NormalTok{fbrand), }\AttributeTok{FUN =}\NormalTok{ mean), }\AttributeTok{by =} \StringTok{"Group.1"}\NormalTok{)}
\FunctionTok{names}\NormalTok{(elas) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"fbrand"}\NormalTok{, }\StringTok{"mean\_utility\_"}\NormalTok{, }\StringTok{"Avg\_Shelf\_Price\_"}\NormalTok{)}
\NormalTok{elas}\SpecialCharTok{$}\NormalTok{op\_el }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(iv5)[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ (elas}\SpecialCharTok{$}\NormalTok{Avg\_Shelf\_Price\_ }\SpecialCharTok{/}\NormalTok{ elas}\SpecialCharTok{$}\NormalTok{mean\_utility\_)}
\FunctionTok{datasummary}\NormalTok{(}\FunctionTok{Heading}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ mean }\SpecialCharTok{*}\NormalTok{ fbrand }\SpecialCharTok{\textasciitilde{}} \FunctionTok{Heading}\NormalTok{(}\StringTok{"Own{-}price elasticity"}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ op\_el,}
\NormalTok{             elas, }\AttributeTok{fmt =} \DecValTok{4}\NormalTok{, }\AttributeTok{output =} \StringTok{"markdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tblr}[         %% tabularray outer open
]                     %% tabularray outer close
{                     %% tabularray inner open
colspec={Q[]Q[]Q[]},
column{1}={halign=l,},
column{2}={halign=l,},
column{3}={halign=r,},
}                     %% tabularray inner close
\toprule
& fbrand & Own-price elasticity \\ \midrule %% TinyTableHeader
& GM & 0.4770 \\
& KG & 0.4662 \\
& NB & 0.3999 \\
& PT & 0.3972 \\
& QK & 0.3095 \\
& RL & 0.4402 \\
\bottomrule
\end{tblr}
\end{table}

侶 = 留pj (1  sj ), if j = k -\textgreater{} so own price elasticities 侶
= 留pk sk , else (meaning j not equal to k) -\textgreater{} cross price
elasticities

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iv2a\_6)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TSLS estimation - Dep. Var.: mean_utility
##                   Endo.    : `Avg Shelf Price`
##                   Instr.   : `Avg Trans Price`:fbrand
## Second stage: Dep. Var.: mean_utility
## Observations: 50
## Fixed-effects: fbrand: 6
## Standard-errors: IID 
##                        Estimate Std. Error   t value Pr(>|t|)    
## fit_`Avg Shelf Price` -0.409198   0.169093 -2.419955 0.020159 *  
## Cals                   0.001275   0.002725  0.467916 0.642384    
## Fat                    0.011934   0.060372  0.197672 0.844303    
## Sugar                 -0.037855   0.014514 -2.608192 0.012736 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.391589     Adj. R2: 0.24062
##                  Within R2: 0.31325
## F-test (1st stage), `Avg Shelf Price`: stat = 30.7     , p = 1.451e-12, on 6 and 35 DoF.
##                            Wu-Hausman: stat =  0.249329, p = 0.620353 , on 1 and 39 DoF.
##                                Sargan: stat =  9.92037 , p = 0.077523 , on 5 DoF.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{coefficients }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(iv2a\_6)}
\FunctionTok{print}\NormalTok{(coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## fit_`Avg Shelf Price`                  Cals                   Fat 
##          -0.409197729           0.001274948           0.011933827 
##                 Sugar 
##          -0.037854966
\end{verbatim}

侶 = 留pj (1  sj ), if j = k -\textgreater{} so own price elasticities 侶
= 留pk sk , else (meaning j not equal to k) -\textgreater{} cross price
elasticities

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 5.67 4.38 4.04 3.82 2.73 2.36 2.26 2.16 2.12 2.08 1.96 1.84 1.55 1.53 1.52
## [16] 1.46 1.26 1.46 1.35 1.31 1.28 1.24 1.23 1.20 1.17 1.13 1.12 1.12 1.08 1.08
## [31] 1.06 1.06 0.99 0.95 0.89 0.97 0.94 0.89 0.89 0.89 0.84 0.83 0.80 0.83 0.78
## [46] 0.76 0.73 0.75 0.74 0.67
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extract coefficients}
\NormalTok{coefficients }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(iv2a\_6)}

\CommentTok{\# Calculate own{-}price elasticity (j = k)}
\NormalTok{own\_price\_elasticity }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{coefficients[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\SpecialCharTok{/}\DecValTok{100}\NormalTok{))}

\CommentTok{\# Calculate cross{-}price elasticity (j  k)}
\NormalTok{cross\_price\_elasticity }\OtherTok{\textless{}{-}}\NormalTok{ coefficients [}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{]}\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}} \SpecialCharTok{*}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\SpecialCharTok{/}\DecValTok{100}\NormalTok{)}


\FunctionTok{print}\NormalTok{(}\StringTok{"Own{-}price elasticity:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Own-price elasticity:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(own\_price\_elasticity)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 0.7526926 1.3577238 1.2565317 1.0547579 0.9950666 1.6141443 1.3638290
##  [8] 1.5133572 0.9091866 1.2220936 1.0230025 1.1045883 1.2488510 1.0395775
## [15] 1.1525169 1.0362842 1.3697018 1.4878945 1.2998289 1.4659292 1.4825332
## [22] 1.4305978 1.4388260 1.5201205 1.2536714 1.7073014 1.1329212 1.4121054
## [29] 1.5907791 1.5057756 1.3562818 1.4210594 1.2356973 1.2888869 1.3910566
## [36] 1.2318947 1.0985019 1.4316122 1.4194455 1.5005567 1.5865234 1.1605920
## [43] 1.2177724 1.4121888 1.4291411 1.2751158 1.4298613 1.5189215 1.4906427
## [50] 0.7194273
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\StringTok{"Cross{-}price elasticity:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Cross-price elasticity:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(cross\_price\_elasticity)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -0.045242947 -0.062192326 -0.052901082 -0.041892027 -0.027927745
##  [6] -0.039014548 -0.031535232 -0.033410176 -0.019692232 -0.025959504
## [11] -0.020451702 -0.020705405 -0.019661951 -0.016152671 -0.017788644
## [16] -0.015353917 -0.017478472 -0.022045118 -0.017787825 -0.019458580
## [21] -0.019222473 -0.017962144 -0.017917950 -0.018463002 -0.014841602
## [26] -0.019513003 -0.012832441 -0.015994721 -0.017367988 -0.016439928
## [31] -0.014530611 -0.015224611 -0.012355725 -0.012361863 -0.012491579
## [36] -0.012066423 -0.010423903 -0.012855765 -0.012746509 -0.013474881
## [41] -0.013439690 -0.009713536 -0.009820745 -0.011819267 -0.011234933
## [46] -0.009765095 -0.010514745 -0.011477996 -0.011112992 -0.004852676
\end{verbatim}

\#Plot own price elasticities against prices

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}

\CommentTok{\# Create a data frame with the own price elasticities and prices}
\NormalTok{elasticity\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{Avg\_Shelf\_Price =}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{,}
  \AttributeTok{Own\_Price\_Elasticity =}\NormalTok{ own\_price\_elasticity}
\NormalTok{)}

\CommentTok{\# Plot own price elasticities against prices using ggplot2}
\NormalTok{plot\_elas\_1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(elasticity\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Avg\_Shelf\_Price, }\AttributeTok{y =}\NormalTok{ Own\_Price\_Elasticity)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"loess"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Average Shelf Price"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Own{-}price Elasticity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Own price elasticities against price.jpeg"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ plot\_elas\_1, }\AttributeTok{dpi =} \DecValTok{900}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saving 6.5 x 4.5 in image
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(plot\_elas\_1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-68-1.pdf}

\#Plot markups against prices

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(dplyr)}

\CommentTok{\# Calculate markup as a percentage}
\NormalTok{cerealdata }\OtherTok{\textless{}{-}}\NormalTok{ cerealdata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{markup\_percentage =}\NormalTok{ discount\_coupon }\SpecialCharTok{*} \DecValTok{100}\NormalTok{)}

\CommentTok{\# Plot markups against prices using ggplot2}
\NormalTok{plot\_elas\_2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(cerealdata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =}\NormalTok{ markup\_percentage)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"loess"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Average Shelf Price"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Markup (\%)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Markups against prices.jpeg"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ plot\_elas\_2, }\AttributeTok{dpi =} \DecValTok{900}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saving 6.5 x 4.5 in image
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(plot\_elas\_2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{Final_EP_CerealData_files/figure-latex/unnamed-chunk-69-1.pdf}

\#matrix 50X 50

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extract coefficients}
\NormalTok{coefficients }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(iv2a\_6)}

\CommentTok{\# Get the number of products}
\NormalTok{num\_products }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(cerealdata)}

\CommentTok{\# Initialize an empty matrix to store the elasticities}
\NormalTok{elasticity\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_products, }\AttributeTok{ncol =}\NormalTok{ num\_products)}

\CommentTok{\# Calculate own{-}price elasticity (j = k) and cross{-}price elasticity (j  k)}
\ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_products) \{}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_products) \{}
    \ControlFlowTok{if}\NormalTok{ (j }\SpecialCharTok{==}\NormalTok{ k) \{}
      \CommentTok{\# Calculate own{-}price elasticity}
\NormalTok{      elasticity\_matrix[j, k] }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{coefficients[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{[j] }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{[j]}\SpecialCharTok{/}\DecValTok{100}\NormalTok{))}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
      \CommentTok{\# Calculate cross{-}price elasticity}
\NormalTok{      elasticity\_matrix[j, k] }\OtherTok{\textless{}{-}}\NormalTok{ coefficients[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{[j] }\SpecialCharTok{*}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{[k]}\SpecialCharTok{/}\DecValTok{100}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}

\FunctionTok{write.csv}\NormalTok{(elasticity\_matrix, }\AttributeTok{file =} \StringTok{"elasticity\_matrix.csv"}\NormalTok{, }\AttributeTok{row.names =} \ConstantTok{FALSE}\NormalTok{)}

\CommentTok{\# Print the elasticity matrix}
\FunctionTok{print}\NormalTok{(elasticity\_matrix)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              [,1]        [,2]        [,3]        [,4]        [,5]        [,6]
##  [1,]  0.75269262 -0.03494958 -0.03223660 -0.03048114 -0.02178364 -0.01883128
##  [2,] -0.08050924  1.35772379 -0.05736461 -0.05424080 -0.03876371 -0.03351002
##  [3,] -0.07424484 -0.05735315  1.25653165 -0.05002033 -0.03574751 -0.03090261
##  [4,] -0.06218005 -0.04803327 -0.04430466  1.05475789 -0.02993854 -0.02588094
##  [5,] -0.05800378 -0.04480715 -0.04132897 -0.03907838  0.99506658 -0.02414267
##  [6,] -0.09373411 -0.07240836 -0.06678762 -0.06315067 -0.04513124  1.61414428
##  [7,] -0.07911715 -0.06111695 -0.05637272 -0.05330291 -0.03809344 -0.03293060
##  [8,] -0.08770171 -0.06774841 -0.06248940 -0.05908652 -0.04222675 -0.03650371
##  [9,] -0.05266743 -0.04068489 -0.03752671 -0.03548317 -0.02535839 -0.02192154
## [10,] -0.07076461 -0.05466472 -0.05042134 -0.04767563 -0.03407185 -0.02945405
## [11,] -0.05916385 -0.04570329 -0.04215555 -0.03985995 -0.02848630 -0.02462552
## [12,] -0.06380416 -0.04928787 -0.04546187 -0.04298622 -0.03072052 -0.02655693
## [13,] -0.07192468 -0.05556087 -0.05124792 -0.04845720 -0.03463040 -0.02993691
## [14,] -0.05985990 -0.04624098 -0.04265150 -0.04032889 -0.02882143 -0.02491523
## [15,] -0.06635632 -0.05125938 -0.04728034 -0.04470567 -0.03194934 -0.02761921
## [16,] -0.05962788 -0.04606175 -0.04248618 -0.04017258 -0.02870972 -0.02481866
## [17,] -0.07865312 -0.06075850 -0.05604208 -0.05299029 -0.03787002 -0.03273746
## [18,] -0.08561358 -0.06613536 -0.06100156 -0.05767969 -0.04122135 -0.03563458
## [19,] -0.07470887 -0.05771161 -0.05323171 -0.05033296 -0.03597094 -0.03109575
## [20,] -0.08422149 -0.06505998 -0.06000967 -0.05674181 -0.04055109 -0.03505515
## [21,] -0.08514955 -0.06577690 -0.06067093 -0.05736707 -0.04099793 -0.03544143
## [22,] -0.08213335 -0.06344693 -0.05852182 -0.05533499 -0.03954569 -0.03418602
## [23,] -0.08259738 -0.06380538 -0.05885245 -0.05564762 -0.03976911 -0.03437916
## [24,] -0.08723768 -0.06738996 -0.06215877 -0.05877389 -0.04200333 -0.03631057
## [25,] -0.07192468 -0.05556087 -0.05124792 -0.04845720 -0.03463040 -0.02993691
## [26,] -0.09791038 -0.07563447 -0.06976330 -0.06596431 -0.04714203 -0.04075282
## [27,] -0.06496423 -0.05018401 -0.04628845 -0.04376779 -0.03127907 -0.02703979
## [28,] -0.08097327 -0.06255078 -0.05769524 -0.05455342 -0.03898713 -0.03370316
## [29,] -0.09118194 -0.07043684 -0.06496914 -0.06143122 -0.04390242 -0.03795227
## [30,] -0.08630962 -0.06667304 -0.06149751 -0.05814863 -0.04155648 -0.03592429
## [31,] -0.07772506 -0.06004158 -0.05538082 -0.05236503 -0.03742318 -0.03235117
## [32,] -0.08143730 -0.06290924 -0.05802587 -0.05486605 -0.03921055 -0.03389630
## [33,] -0.07076461 -0.05466472 -0.05042134 -0.04767563 -0.03407185 -0.02945405
## [34,] -0.07378081 -0.05699470 -0.05257045 -0.04970770 -0.03552409 -0.03070947
## [35,] -0.07958118 -0.06147541 -0.05670335 -0.05361554 -0.03831687 -0.03312374
## [36,] -0.07053259 -0.05448550 -0.05025603 -0.04751931 -0.03396014 -0.02935748
## [37,] -0.06287610 -0.04857095 -0.04480060 -0.04236097 -0.03027368 -0.02617065
## [38,] -0.08190133 -0.06326770 -0.05835651 -0.05517868 -0.03943398 -0.03408944
## [39,] -0.08120529 -0.06273001 -0.05786056 -0.05470974 -0.03909884 -0.03379973
## [40,] -0.08584559 -0.06631458 -0.06116688 -0.05783601 -0.04133306 -0.03573115
## [41,] -0.09071791 -0.07007838 -0.06463851 -0.06111859 -0.04367899 -0.03775913
## [42,] -0.06635632 -0.05125938 -0.04728034 -0.04470567 -0.03194934 -0.02761921
## [43,] -0.06960453 -0.05376858 -0.04959476 -0.04689406 -0.03351329 -0.02897120
## [44,] -0.08074126 -0.06237155 -0.05752993 -0.05439711 -0.03887542 -0.03360659
## [45,] -0.08166932 -0.06308847 -0.05819119 -0.05502236 -0.03932226 -0.03399287
## [46,] -0.07285275 -0.05627778 -0.05190919 -0.04908245 -0.03507725 -0.03032319
## [47,] -0.08166932 -0.06308847 -0.05819119 -0.05502236 -0.03932226 -0.03399287
## [48,] -0.08677365 -0.06703150 -0.06182814 -0.05846126 -0.04177991 -0.03611743
## [49,] -0.08514955 -0.06577690 -0.06067093 -0.05736707 -0.04099793 -0.03544143
## [50,] -0.04106667 -0.03172346 -0.02926091 -0.02766750 -0.01977284 -0.01709301
##              [,7]        [,8]        [,9]       [,10]       [,11]       [,12]
##  [1,] -0.01803334 -0.01723541 -0.01691623 -0.01659706 -0.01563954 -0.01468201
##  [2,] -0.03209010 -0.03067019 -0.03010222 -0.02953426 -0.02783036 -0.02612646
##  [3,] -0.02959318 -0.02828375 -0.02775997 -0.02723620 -0.02566488 -0.02409356
##  [4,] -0.02478429 -0.02368764 -0.02324898 -0.02281032 -0.02149434 -0.02017836
##  [5,] -0.02311967 -0.02209668 -0.02168748 -0.02127828 -0.02005069 -0.01882310
##  [6,] -0.03736139 -0.03570823 -0.03504697 -0.03438570 -0.03240191 -0.03041812
##  [7,]  1.36382902 -0.03013987 -0.02958172 -0.02902358 -0.02734914 -0.02567470
##  [8,] -0.03495694  1.51335724 -0.03279147 -0.03217276 -0.03031664 -0.02846052
##  [9,] -0.02099266 -0.02006378  0.90918661 -0.01932068 -0.01820603 -0.01709137
## [10,] -0.02820600 -0.02695795 -0.02645873  1.22209357 -0.02446184 -0.02296418
## [11,] -0.02358207 -0.02253861 -0.02212123 -0.02170385  1.02300251 -0.01919956
## [12,] -0.02543164 -0.02430635 -0.02385623 -0.02340611 -0.02205576  1.10458835
## [13,] -0.02866839 -0.02739988 -0.02689247 -0.02638507 -0.02486285 -0.02334064
## [14,] -0.02385950 -0.02280377 -0.02238148 -0.02195919 -0.02069231 -0.01942543
## [15,] -0.02644890 -0.02527860 -0.02481048 -0.02434235 -0.02293799 -0.02153362
## [16,] -0.02376702 -0.02271538 -0.02229473 -0.02187407 -0.02061211 -0.01935014
## [17,] -0.03135027 -0.02996309 -0.02940822 -0.02885335 -0.02718873 -0.02552412
## [18,] -0.03412464 -0.03261470 -0.03201072 -0.03140674 -0.02959482 -0.02778289
## [19,] -0.02977814 -0.02846052 -0.02793347 -0.02740643 -0.02582529 -0.02424415
## [20,] -0.03356976 -0.03208438 -0.03149022 -0.03089607 -0.02911360 -0.02733113
## [21,] -0.03393968 -0.03243792 -0.03183722 -0.03123652 -0.02943441 -0.02763230
## [22,] -0.03273746 -0.03128890 -0.03070947 -0.03013005 -0.02839178 -0.02665350
## [23,] -0.03292241 -0.03146567 -0.03088297 -0.03030027 -0.02855218 -0.02680409
## [24,] -0.03477199 -0.03323340 -0.03261797 -0.03200254 -0.03015624 -0.02830994
## [25,] -0.02866839 -0.02739988 -0.02689247 -0.02638507 -0.02486285 -0.02334064
## [26,] -0.03902601 -0.03729919 -0.03660847 -0.03591774 -0.03384556 -0.03177339
## [27,] -0.02589403 -0.02474828 -0.02428998 -0.02383168 -0.02245677 -0.02108187
## [28,] -0.03227506 -0.03084696 -0.03027572 -0.02970448 -0.02799076 -0.02627704
## [29,] -0.03634412 -0.03473598 -0.03409272 -0.03344946 -0.03151968 -0.02958991
## [30,] -0.03440207 -0.03287986 -0.03227097 -0.03166208 -0.02983542 -0.02800877
## [31,] -0.03098036 -0.02960955 -0.02906122 -0.02851290 -0.02686792 -0.02522295
## [32,] -0.03246002 -0.03102374 -0.03044922 -0.02987471 -0.02815117 -0.02642763
## [33,] -0.02820600 -0.02695795 -0.02645873 -0.02595950 -0.02446184 -0.02296418
## [34,] -0.02940822 -0.02810697 -0.02758647 -0.02706597 -0.02550448 -0.02394298
## [35,] -0.03172019 -0.03031664 -0.02975522 -0.02919380 -0.02750954 -0.02582529
## [36,] -0.02811352 -0.02686956 -0.02637198 -0.02587439 -0.02438164 -0.02288888
## [37,] -0.02506172 -0.02395280 -0.02350923 -0.02306566 -0.02173495 -0.02040424
## [38,] -0.03264498 -0.03120051 -0.03062272 -0.03004493 -0.02831157 -0.02657821
## [39,] -0.03236754 -0.03093535 -0.03036247 -0.02978959 -0.02807096 -0.02635233
## [40,] -0.03421711 -0.03270308 -0.03209747 -0.03149186 -0.02967502 -0.02785818
## [41,] -0.03615917 -0.03455920 -0.03391922 -0.03327923 -0.03135928 -0.02943932
## [42,] -0.02644890 -0.02527860 -0.02481048 -0.02434235 -0.02293799 -0.02153362
## [43,] -0.02774361 -0.02651601 -0.02602498 -0.02553394 -0.02406083 -0.02258771
## [44,] -0.03218258 -0.03075857 -0.03018897 -0.02961937 -0.02791056 -0.02620175
## [45,] -0.03255250 -0.03111212 -0.03053597 -0.02995982 -0.02823137 -0.02650292
## [46,] -0.02903831 -0.02775343 -0.02723947 -0.02672552 -0.02518367 -0.02364181
## [47,] -0.03255250 -0.03111212 -0.03053597 -0.02995982 -0.02823137 -0.02650292
## [48,] -0.03458703 -0.03305663 -0.03244447 -0.03183231 -0.02999583 -0.02815935
## [49,] -0.03393968 -0.03243792 -0.03183722 -0.03123652 -0.02943441 -0.02763230
## [50,] -0.01636873 -0.01564445 -0.01535474 -0.01506502 -0.01419589 -0.01332675
##             [,13]       [,14]       [,15]       [,16]        [,17]       [,18]
##  [1,] -0.01236800 -0.01220841 -0.01212862 -0.01164986 -0.010053988 -0.01164986
##  [2,] -0.02200870 -0.02172472 -0.02158273 -0.02073078 -0.017890943 -0.02073078
##  [3,] -0.02029621 -0.02003432 -0.01990338 -0.01911772 -0.016498852 -0.01911772
##  [4,] -0.01699807 -0.01677874 -0.01666908 -0.01601109 -0.013817789 -0.01601109
##  [5,] -0.01585641 -0.01565181 -0.01554951 -0.01493572 -0.012889728 -0.01493572
##  [6,] -0.02562396 -0.02529333 -0.02512801 -0.02413612 -0.020829801 -0.02413612
##  [7,] -0.02162815 -0.02134907 -0.02120954 -0.02037232 -0.017581590 -0.02037232
##  [8,] -0.02397489 -0.02366554 -0.02351086 -0.02258280 -0.019489269 -0.02258280
##  [9,] -0.01439762 -0.01421185 -0.01411896 -0.01356163 -0.011703873 -0.01356163
## [10,] -0.01934482 -0.01909521 -0.01897041 -0.01822157 -0.015725469 -0.01822157
## [11,] -0.01617354 -0.01596485 -0.01586050 -0.01523443 -0.013147523 -0.01523443
## [12,] -0.01744205 -0.01721699 -0.01710447 -0.01642929 -0.014178701 -0.01642929
## [13,]  1.24885101 -0.01940825 -0.01928140 -0.01852029 -0.015983263 -0.01852029
## [14,] -0.01636382  1.03957747 -0.01604710 -0.01541366 -0.013302200 -0.01541366
## [15,] -0.01813974 -0.01790567  1.15251686 -0.01708646 -0.014745849 -0.01708646
## [16,] -0.01630039 -0.01609006 -0.01598490  1.03628425 -0.013250641 -0.01535392
## [17,] -0.02150129 -0.02122386 -0.02108514 -0.02025283  1.369701830 -0.02025283
## [18,] -0.02340406 -0.02310208 -0.02295108 -0.02204512 -0.019025239  1.48789450
## [19,] -0.02042306 -0.02015954 -0.02002777 -0.01923720 -0.016601970 -0.01923720
## [20,] -0.02302351 -0.02272643 -0.02257789 -0.02168666 -0.018715886 -0.02168666
## [21,] -0.02327721 -0.02297686 -0.02282669 -0.02192563 -0.018922121 -0.02192563
## [22,] -0.02245268 -0.02216297 -0.02201811 -0.02114898 -0.018251856 -0.02114898
## [23,] -0.02257953 -0.02228818 -0.02214251 -0.02126846 -0.018354973 -0.02126846
## [24,] -0.02384804 -0.02354033 -0.02338647 -0.02246332 -0.019386152 -0.02246332
## [25,] -0.01966195 -0.01940825 -0.01928140 -0.01852029 -0.015983263 -0.01852029
## [26,] -0.02676562 -0.02642026 -0.02624758 -0.02521149 -0.021757862 -0.02521149
## [27,] -0.01775918 -0.01753003 -0.01741546 -0.01672800 -0.014436496 -0.01672800
## [28,] -0.02213555 -0.02184993 -0.02170712 -0.02085026 -0.017994061 -0.02085026
## [29,] -0.02492628 -0.02460465 -0.02444384 -0.02347895 -0.020262653 -0.02347895
## [30,] -0.02359434 -0.02328990 -0.02313768 -0.02222435 -0.019179916 -0.02222435
## [31,] -0.02124759 -0.02097343 -0.02083635 -0.02001386 -0.017272236 -0.02001386
## [32,] -0.02226240 -0.02197515 -0.02183152 -0.02096975 -0.018097179 -0.02096975
## [33,] -0.01934482 -0.01909521 -0.01897041 -0.01822157 -0.015725469 -0.01822157
## [34,] -0.02016936 -0.01990911 -0.01977898 -0.01899823 -0.016395735 -0.01899823
## [35,] -0.02175500 -0.02147429 -0.02133393 -0.02049180 -0.017684707 -0.02049180
## [36,] -0.01928140 -0.01903260 -0.01890821 -0.01816183 -0.015673910 -0.01816183
## [37,] -0.01718835 -0.01696657 -0.01685567 -0.01619032 -0.013972466 -0.01619032
## [38,] -0.02238925 -0.02210036 -0.02195591 -0.02108923 -0.018200297 -0.02108923
## [39,] -0.02219898 -0.02191254 -0.02176932 -0.02091000 -0.018045620 -0.02091000
## [40,] -0.02346749 -0.02316468 -0.02301328 -0.02210486 -0.019076798 -0.02210486
## [41,] -0.02479943 -0.02447944 -0.02431944 -0.02335946 -0.020159535 -0.02335946
## [42,] -0.01813974 -0.01790567 -0.01778864 -0.01708646 -0.014745849 -0.01708646
## [43,] -0.01902769 -0.01878218 -0.01865942 -0.01792286 -0.015467674 -0.01792286
## [44,] -0.02207213 -0.02178732 -0.02164492 -0.02079052 -0.017942502 -0.02079052
## [45,] -0.02232583 -0.02203775 -0.02189372 -0.02102949 -0.018148738 -0.02102949
## [46,] -0.01991565 -0.01965868 -0.01953019 -0.01875926 -0.016189499 -0.01875926
## [47,] -0.02232583 -0.02203775 -0.02189372 -0.02102949 -0.018148738 -0.02102949
## [48,] -0.02372119 -0.02341511 -0.02326207 -0.02234383 -0.019283034 -0.02234383
## [49,] -0.02327721 -0.02297686 -0.02282669 -0.02192563 -0.018922121 -0.02192563
## [50,] -0.01122634 -0.01108148 -0.01100906 -0.01057449 -0.009125928 -0.01057449
##             [,19]        [,20]        [,21]        [,22]        [,23]
##  [1,] -0.01077213 -0.010452956 -0.010213575 -0.009894401 -0.009814608
##  [2,] -0.01916887 -0.018600901 -0.018174926 -0.017606960 -0.017464968
##  [3,] -0.01767734 -0.017153569 -0.016760739 -0.016236966 -0.016106023
##  [4,] -0.01480477 -0.014366114 -0.014037119 -0.013598459 -0.013488794
##  [5,] -0.01381042 -0.013401226 -0.013094327 -0.012685130 -0.012582830
##  [6,] -0.02231764 -0.021656381 -0.021160433 -0.020499169 -0.020333854
##  [7,] -0.01883742 -0.018279272 -0.017860662 -0.017302517 -0.017162980
##  [8,] -0.02088136 -0.020262653 -0.019798623 -0.019179916 -0.019025239
##  [9,] -0.01253986 -0.012168313 -0.011889649 -0.011518098 -0.011425210
## [10,] -0.01684872 -0.016349495 -0.015975079 -0.015475858 -0.015351053
## [11,] -0.01408663 -0.013669250 -0.013356214 -0.012938832 -0.012834487
## [12,] -0.01519147 -0.014741348 -0.014403760 -0.013953643 -0.013841113
## [13,] -0.01712492 -0.016617520 -0.016236966 -0.015729561 -0.015602709
## [14,] -0.01425236 -0.013830065 -0.013513346 -0.013091054 -0.012985481
## [15,] -0.01579912 -0.015331002 -0.014979910 -0.014511788 -0.014394758
## [16,] -0.01419712 -0.013776460 -0.013460968 -0.013040313 -0.012935149
## [17,] -0.01872693 -0.018172062 -0.017755908 -0.017201036 -0.017062318
## [18,] -0.02038418 -0.019780209 -0.019327227 -0.018723251 -0.018572257
## [19,]  1.29982886 -0.017260779 -0.016865494 -0.016338447 -0.016206685
## [20,] -0.02005273  1.465929177 -0.019012963 -0.018418808 -0.018270269
## [21,] -0.02027370 -0.019672999  1.482533193 -0.018621770 -0.018471595
## [22,] -0.01955556 -0.018976135 -0.018541567  1.430597817 -0.017817288
## [23,] -0.01966604 -0.019083345 -0.018646322 -0.018063625  1.438825965
## [24,] -0.02077088 -0.020155443 -0.019693868 -0.019078435 -0.018924577
## [25,] -0.01712492 -0.016617520 -0.016236966 -0.015729561 -0.015602709
## [26,] -0.02331199 -0.022621269 -0.022103225 -0.021412499 -0.021239817
## [27,] -0.01546767 -0.015009373 -0.014665647 -0.014207345 -0.014092770
## [28,] -0.01927935 -0.018708111 -0.018279681 -0.017708441 -0.017565631
## [29,] -0.02170999 -0.021066727 -0.020584283 -0.019941024 -0.019780209
## [30,] -0.02054991 -0.019941024 -0.019484359 -0.018875473 -0.018723251
## [31,] -0.01850597 -0.017957642 -0.017546399 -0.016998074 -0.016860992
## [32,] -0.01938983 -0.018815321 -0.018384436 -0.017809922 -0.017666294
## [33,] -0.01684872 -0.016349495 -0.015975079 -0.015475858 -0.015351053
## [34,] -0.01756686 -0.017046359 -0.016655984 -0.016135485 -0.016005360
## [35,] -0.01894790 -0.018386482 -0.017965417 -0.017403998 -0.017263643
## [36,] -0.01679347 -0.016295890 -0.015922702 -0.015425118 -0.015300721
## [37,] -0.01497050 -0.014526929 -0.014194251 -0.013750680 -0.013639788
## [38,] -0.01950032 -0.018922531 -0.018489190 -0.017911403 -0.017766956
## [39,] -0.01933459 -0.018761716 -0.018332058 -0.017759181 -0.017615962
## [40,] -0.02043943 -0.019833814 -0.019379604 -0.018773992 -0.018622589
## [41,] -0.02159950 -0.020959517 -0.020479528 -0.019839543 -0.019679546
## [42,] -0.01579912 -0.015331002 -0.014979910 -0.014511788 -0.014394758
## [43,] -0.01657251 -0.016081471 -0.015713193 -0.015222156 -0.015099396
## [44,] -0.01922411 -0.018654506 -0.018227304 -0.017657700 -0.017515300
## [45,] -0.01944508 -0.018868926 -0.018436813 -0.017860662 -0.017716625
## [46,] -0.01734589 -0.016831939 -0.016446475 -0.015932523 -0.015804035
## [47,] -0.01944508 -0.018868926 -0.018436813 -0.017860662 -0.017716625
## [48,] -0.02066039 -0.020048234 -0.019589114 -0.018976954 -0.018823914
## [49,] -0.02027370 -0.019672999 -0.019222473 -0.018621770 -0.018471595
## [50,] -0.00977778 -0.009488068 -0.009270784 -0.008981072 -0.008908644
##              [,24]        [,25]        [,26]        [,27]        [,28]
##  [1,] -0.009575227 -0.009335846 -0.009016672 -0.008936878 -0.008936878
##  [2,] -0.017038993 -0.016613019 -0.016045052 -0.015903061 -0.015903061
##  [3,] -0.015713193 -0.015320363 -0.014796590 -0.014665647 -0.014665647
##  [4,] -0.013159799 -0.012830804 -0.012392144 -0.012282479 -0.012282479
##  [5,] -0.012275932 -0.011969034 -0.011559836 -0.011457536 -0.011457536
##  [6,] -0.019837906 -0.019341958 -0.018680695 -0.018515379 -0.018515379
##  [7,] -0.016744371 -0.016325762 -0.015767616 -0.015628080 -0.015628080
##  [8,] -0.018561209 -0.018097179 -0.017478472 -0.017323795 -0.017323795
##  [9,] -0.011146546 -0.010867882 -0.010496331 -0.010403443 -0.010403443
## [10,] -0.014976637 -0.014602221 -0.014103000 -0.013978194 -0.013978194
## [11,] -0.012521451 -0.012208414 -0.011791033 -0.011686687 -0.011686687
## [12,] -0.013503525 -0.013165937 -0.012715819 -0.012603290 -0.012603290
## [13,] -0.015222156 -0.014841602 -0.014334196 -0.014207345 -0.014207345
## [14,] -0.012668762 -0.012352043 -0.011929751 -0.011824178 -0.011824178
## [15,] -0.014043666 -0.013692574 -0.013224452 -0.013107422 -0.013107422
## [16,] -0.012619658 -0.012304167 -0.011883511 -0.011778347 -0.011778347
## [17,] -0.016646164 -0.016230010 -0.015675137 -0.015536419 -0.015536419
## [18,] -0.018119275 -0.017666294 -0.017062318 -0.016911324 -0.016911324
## [19,] -0.015811400 -0.015416115 -0.014889069 -0.014757307 -0.014757307
## [20,] -0.017824653 -0.017379037 -0.016784882 -0.016636343 -0.016636343
## [21,] -0.018021068 -0.017570541 -0.016969839 -0.016819663 -0.016819663
## [22,] -0.017382720 -0.016948152 -0.016368728 -0.016223872 -0.016223872
## [23,] -0.017480927 -0.017043904 -0.016461206 -0.016315532 -0.016315532
## [24,]  1.520120460 -0.018001426 -0.017385993 -0.017232135 -0.017232135
## [25,] -0.015222156  1.253671358 -0.014334196 -0.014207345 -0.014207345
## [26,] -0.020721773 -0.020203729  1.707301414 -0.019340321 -0.019340321
## [27,] -0.013749044 -0.013405318 -0.012947016  1.132921200 -0.012832441
## [28,] -0.017137201 -0.016708771 -0.016137531 -0.015994721  1.412105353
## [29,] -0.019297765 -0.018815321 -0.018172062 -0.018011247 -0.018011247
## [30,] -0.018266587 -0.017809922 -0.017201036 -0.017048814 -0.017048814
## [31,] -0.016449749 -0.016038505 -0.015490180 -0.015353099 -0.015353099
## [32,] -0.017235408 -0.016804523 -0.016230010 -0.016086381 -0.016086381
## [33,] -0.014976637 -0.014602221 -0.014103000 -0.013978194 -0.013978194
## [34,] -0.015614985 -0.015224611 -0.014704111 -0.014573986 -0.014573986
## [35,] -0.016842579 -0.016421514 -0.015860095 -0.015719740 -0.015719740
## [36,] -0.014927533 -0.014554345 -0.014056760 -0.013932364 -0.013932364
## [37,] -0.013307110 -0.012974432 -0.012530862 -0.012419969 -0.012419969
## [38,] -0.017333616 -0.016900275 -0.016322488 -0.016178041 -0.016178041
## [39,] -0.017186305 -0.016756647 -0.016183770 -0.016040551 -0.016040551
## [40,] -0.018168379 -0.017714170 -0.017108557 -0.016957154 -0.016957154
## [41,] -0.019199557 -0.018719569 -0.018079583 -0.017919587 -0.017919587
## [42,] -0.014043666 -0.013692574 -0.013224452 -0.013107422 -0.013107422
## [43,] -0.014731118 -0.014362840 -0.013871803 -0.013749044 -0.013749044
## [44,] -0.017088097 -0.016660895 -0.016091291 -0.015948891 -0.015948891
## [45,] -0.017284512 -0.016852399 -0.016276249 -0.016132211 -0.016132211
## [46,] -0.015418570 -0.015033106 -0.014519154 -0.014390666 -0.014390666
## [47,] -0.017284512 -0.016852399 -0.016276249 -0.016132211 -0.016132211
## [48,] -0.018364794 -0.017905674 -0.017293514 -0.017140474 -0.017140474
## [49,] -0.018021068 -0.017570541 -0.016969839 -0.016819663 -0.016819663
## [50,] -0.008691360 -0.008474076 -0.008184364 -0.008111936 -0.008111936
##              [,29]        [,30]        [,31]        [,32]        [,33]
##  [1,] -0.008617704 -0.008617704 -0.008458117 -0.008458117 -0.007899562
##  [2,] -0.015335094 -0.015335094 -0.015051111 -0.015051111 -0.014057170
##  [3,] -0.014141874 -0.014141874 -0.013879987 -0.013879987 -0.012963384
##  [4,] -0.011843819 -0.011843819 -0.011624489 -0.011624489 -0.010856834
##  [5,] -0.011048339 -0.011048339 -0.010843740 -0.010843740 -0.010127644
##  [6,] -0.017854115 -0.017854115 -0.017523484 -0.017523484 -0.016366272
##  [7,] -0.015069934 -0.015069934 -0.014790861 -0.014790861 -0.013814106
##  [8,] -0.016705088 -0.016705088 -0.016395735 -0.016395735 -0.015312997
##  [9,] -0.010031892 -0.010031892 -0.009846116 -0.009846116 -0.009195901
## [10,] -0.013478973 -0.013478973 -0.013229363 -0.013229363 -0.012355725
## [11,] -0.011269305 -0.011269305 -0.011060615 -0.011060615 -0.010330197
## [12,] -0.012153173 -0.012153173 -0.011928114 -0.011928114 -0.011140408
## [13,] -0.013699940 -0.013699940 -0.013446237 -0.013446237 -0.012558278
## [14,] -0.011401886 -0.011401886 -0.011190739 -0.011190739 -0.010451728
## [15,] -0.012639299 -0.012639299 -0.012405238 -0.012405238 -0.011586024
## [16,] -0.011357692 -0.011357692 -0.011147365 -0.011147365 -0.010411218
## [17,] -0.014981547 -0.014981547 -0.014704111 -0.014704111 -0.013733085
## [18,] -0.016307348 -0.016307348 -0.016005360 -0.016005360 -0.014948402
## [19,] -0.014230260 -0.014230260 -0.013966737 -0.013966737 -0.013044405
## [20,] -0.016042188 -0.016042188 -0.015745110 -0.015745110 -0.014705339
## [21,] -0.016218961 -0.016218961 -0.015918610 -0.015918610 -0.014867381
## [22,] -0.015644448 -0.015644448 -0.015354736 -0.015354736 -0.014340744
## [23,] -0.015732834 -0.015732834 -0.015441486 -0.015441486 -0.014421765
## [24,] -0.016616701 -0.016616701 -0.016308985 -0.016308985 -0.015231976
## [25,] -0.013699940 -0.013699940 -0.013446237 -0.013446237 -0.012558278
## [26,] -0.018649596 -0.018649596 -0.018304233 -0.018304233 -0.017095463
## [27,] -0.012374139 -0.012374139 -0.012144989 -0.012144989 -0.011342961
## [28,] -0.015423481 -0.015423481 -0.015137861 -0.015137861 -0.014138191
## [29,]  1.590779087 -0.017367988 -0.017046359 -0.017046359 -0.015920656
## [30,] -0.016439928  1.505775624 -0.016135485 -0.016135485 -0.015069934
## [31,] -0.014804774 -0.014804774  1.356281781 -0.014530611 -0.013571043
## [32,] -0.015511868 -0.015511868 -0.015224611  1.421059418 -0.014219212
## [33,] -0.013478973 -0.013478973 -0.013229363 -0.013229363  1.235697348
## [34,] -0.014053487 -0.014053487 -0.013793237 -0.013793237 -0.012882363
## [35,] -0.015158321 -0.015158321 -0.014877611 -0.014877611 -0.013895127
## [36,] -0.013434780 -0.013434780 -0.013185988 -0.013185988 -0.012315215
## [37,] -0.011976399 -0.011976399 -0.011754614 -0.011754614 -0.010978366
## [38,] -0.015600254 -0.015600254 -0.015311361 -0.015311361 -0.014300233
## [39,] -0.015467674 -0.015467674 -0.015181236 -0.015181236 -0.014178701
## [40,] -0.016351541 -0.016351541 -0.016048735 -0.016048735 -0.014988913
## [41,] -0.017279602 -0.017279602 -0.016959609 -0.016959609 -0.015839635
## [42,] -0.012639299 -0.012639299 -0.012405238 -0.012405238 -0.011586024
## [43,] -0.013258006 -0.013258006 -0.013012488 -0.013012488 -0.012153173
## [44,] -0.015379287 -0.015379287 -0.015094486 -0.015094486 -0.014097680
## [45,] -0.015556061 -0.015556061 -0.015267986 -0.015267986 -0.014259722
## [46,] -0.013876713 -0.013876713 -0.013619737 -0.013619737 -0.012720321
## [47,] -0.015556061 -0.015556061 -0.015267986 -0.015267986 -0.014259722
## [48,] -0.016528315 -0.016528315 -0.016222235 -0.016222235 -0.015150955
## [49,] -0.016218961 -0.016218961 -0.015918610 -0.015918610 -0.014867381
## [50,] -0.007822224 -0.007822224 -0.007677368 -0.007677368 -0.007170372
##              [,34]        [,35]        [,36]        [,37]        [,38]
##  [1,] -0.007580388 -0.007101627 -0.007739975 -0.007500594 -0.007101627
##  [2,] -0.013489203 -0.012637253 -0.013773186 -0.013347212 -0.012637253
##  [3,] -0.012439611 -0.011653951 -0.012701498 -0.012308668 -0.011653951
##  [4,] -0.010418174 -0.009760184 -0.010637504 -0.010308509 -0.009760184
##  [5,] -0.009718446 -0.009104649 -0.009923045 -0.009616147 -0.009104649
##  [6,] -0.015705009 -0.014713114 -0.016035641 -0.015539693 -0.014713114
##  [7,] -0.013255960 -0.012418742 -0.013535033 -0.013116424 -0.012418742
##  [8,] -0.014694290 -0.013766230 -0.015003644 -0.014539614 -0.013766230
##  [9,] -0.008824349 -0.008267022 -0.009010125 -0.008731461 -0.008267022
## [10,] -0.011856504 -0.011107672 -0.012106115 -0.011731699 -0.011107672
## [11,] -0.009912815 -0.009286742 -0.010121506 -0.009808470 -0.009286742
## [12,] -0.010690291 -0.010015114 -0.010915349 -0.010577761 -0.010015114
## [13,] -0.012050873 -0.011289765 -0.012304576 -0.011924022 -0.011289765
## [14,] -0.010029436 -0.009395998 -0.010240582 -0.009923863 -0.009395998
## [15,] -0.011117902 -0.010415719 -0.011351963 -0.011000872 -0.010415719
## [16,] -0.009990563 -0.009359580 -0.010200890 -0.009885399 -0.009359580
## [17,] -0.013178213 -0.012345905 -0.013455649 -0.013039495 -0.012345905
## [18,] -0.014344426 -0.013438463 -0.014646414 -0.014193432 -0.013438463
## [19,] -0.012517359 -0.011726789 -0.012780882 -0.012385597 -0.011726789
## [20,] -0.014111184 -0.013219951 -0.014408261 -0.013962645 -0.013219951
## [21,] -0.014266679 -0.013365625 -0.014567030 -0.014116503 -0.013365625
## [22,] -0.013761320 -0.012892184 -0.014051032 -0.013616464 -0.012892184
## [23,] -0.013839067 -0.012965021 -0.014130416 -0.013693393 -0.012965021
## [24,] -0.014616543 -0.013693393 -0.014924260 -0.014462685 -0.013693393
## [25,] -0.012050873 -0.011289765 -0.012304576 -0.011924022 -0.011289765
## [26,] -0.016404737 -0.015368648 -0.016750100 -0.016232056 -0.015368648
## [27,] -0.010884660 -0.010197207 -0.011113810 -0.010770084 -0.010197207
## [28,] -0.013566951 -0.012710091 -0.013852571 -0.013424141 -0.012710091
## [29,] -0.015277397 -0.014312509 -0.015599027 -0.015116583 -0.014312509
## [30,] -0.014461048 -0.013547718 -0.014765491 -0.014308826 -0.013547718
## [31,] -0.013022718 -0.012200230 -0.013296880 -0.012885636 -0.012200230
## [32,] -0.013644698 -0.012782928 -0.013931955 -0.013501070 -0.012782928
## [33,] -0.011856504 -0.011107672 -0.012106115 -0.011731699 -0.011107672
## [34,]  1.288886915 -0.011581114 -0.012622113 -0.012231739 -0.011581114
## [35,] -0.013333708  1.391056631 -0.013614418 -0.013193353 -0.012491579
## [36,] -0.011817630 -0.011071254  1.231894674 -0.011693234 -0.011071254
## [37,] -0.010534796 -0.009869440 -0.010756581  1.098501943 -0.009869440
## [38,] -0.013722446 -0.012855765 -0.014011339 -0.013577999  1.431612218
## [39,] -0.013605824 -0.012746509 -0.013892263 -0.013462605 -0.012746509
## [40,] -0.014383300 -0.013474881 -0.014686106 -0.014231897 -0.013474881
## [41,] -0.015199650 -0.014239672 -0.015519642 -0.015039653 -0.014239672
## [42,] -0.011117902 -0.010415719 -0.011351963 -0.011000872 -0.010415719
## [43,] -0.011662135 -0.010925579 -0.011907654 -0.011539376 -0.010925579
## [44,] -0.013528077 -0.012673672 -0.013812879 -0.013385676 -0.012673672
## [45,] -0.013683572 -0.012819346 -0.013971647 -0.013539534 -0.012819346
## [46,] -0.012206368 -0.011435440 -0.012463344 -0.012077880 -0.011435440
## [47,] -0.013683572 -0.012819346 -0.013971647 -0.013539534 -0.012819346
## [48,] -0.014538795 -0.013620556 -0.014844875 -0.014385755 -0.013620556
## [49,] -0.014266679 -0.013365625 -0.014567030 -0.014116503 -0.013365625
## [50,] -0.006880660 -0.006446092 -0.007025516 -0.006808232 -0.006446092
##              [,39]        [,40]        [,41]        [,42]        [,43]
##  [1,] -0.007101627 -0.007101627 -0.006702659 -0.006622865 -0.006383485
##  [2,] -0.012637253 -0.012637253 -0.011927295 -0.011785304 -0.011359329
##  [3,] -0.011653951 -0.011653951 -0.010999235 -0.010868292 -0.010475462
##  [4,] -0.009760184 -0.009760184 -0.009211859 -0.009102194 -0.008773199
##  [5,] -0.009104649 -0.009104649 -0.008593152 -0.008490853 -0.008183955
##  [6,] -0.014713114 -0.014713114 -0.013886534 -0.013721218 -0.013225271
##  [7,] -0.012418742 -0.012418742 -0.011721060 -0.011581523 -0.011162914
##  [8,] -0.013766230 -0.013766230 -0.012992846 -0.012838170 -0.012374139
##  [9,] -0.008267022 -0.008267022 -0.007802582 -0.007709694 -0.007431031
## [10,] -0.011107672 -0.011107672 -0.010483646 -0.010358841 -0.009984425
## [11,] -0.009286742 -0.009286742 -0.008765015 -0.008660670 -0.008347634
## [12,] -0.010015114 -0.010015114 -0.009452468 -0.009339938 -0.009002350
## [13,] -0.011289765 -0.011289765 -0.010655509 -0.010528658 -0.010148104
## [14,] -0.009395998 -0.009395998 -0.008868133 -0.008762560 -0.008445841
## [15,] -0.010415719 -0.010415719 -0.009830566 -0.009713536 -0.009362444
## [16,] -0.009359580 -0.009359580 -0.008833761 -0.008728597 -0.008413105
## [17,] -0.012345905 -0.012345905 -0.011652315 -0.011513597 -0.011097442
## [18,] -0.013438463 -0.013438463 -0.012683493 -0.012532499 -0.012079517
## [19,] -0.011726789 -0.011726789 -0.011067980 -0.010936219 -0.010540933
## [20,] -0.013219951 -0.013219951 -0.012477257 -0.012328718 -0.011883102
## [21,] -0.013365625 -0.013365625 -0.012614748 -0.012464572 -0.012014045
## [22,] -0.012892184 -0.012892184 -0.012167904 -0.012023048 -0.011588480
## [23,] -0.012965021 -0.012965021 -0.012236649 -0.012090974 -0.011653951
## [24,] -0.013693393 -0.013693393 -0.012924101 -0.012770243 -0.012308668
## [25,] -0.011289765 -0.011289765 -0.010655509 -0.010528658 -0.010148104
## [26,] -0.015368648 -0.015368648 -0.014505241 -0.014332560 -0.013814515
## [27,] -0.010197207 -0.010197207 -0.009624331 -0.009509755 -0.009166029
## [28,] -0.012710091 -0.012710091 -0.011996041 -0.011853231 -0.011424801
## [29,] -0.014312509 -0.014312509 -0.013508435 -0.013347621 -0.012865177
## [30,] -0.013547718 -0.013547718 -0.012786611 -0.012634389 -0.012177724
## [31,] -0.012200230 -0.012200230 -0.011514824 -0.011377743 -0.010966499
## [32,] -0.012782928 -0.012782928 -0.012064786 -0.011921157 -0.011490272
## [33,] -0.011107672 -0.011107672 -0.010483646 -0.010358841 -0.009984425
## [34,] -0.011581114 -0.011581114 -0.010930490 -0.010800365 -0.010409990
## [35,] -0.012491579 -0.012491579 -0.011789805 -0.011649450 -0.011228386
## [36,] -0.011071254 -0.011071254 -0.010449273 -0.010324877 -0.009951689
## [37,] -0.009869440 -0.009869440 -0.009314977 -0.009204085 -0.008871407
## [38,] -0.012855765 -0.012855765 -0.012133531 -0.011989084 -0.011555744
## [39,]  1.419445542 -0.012746509 -0.012030413 -0.011887194 -0.011457536
## [40,] -0.013474881  1.500556716 -0.012717865 -0.012566462 -0.012112253
## [41,] -0.014239672 -0.014239672  1.586523430 -0.013279694 -0.012799705
## [42,] -0.010415719 -0.010415719 -0.009830566  1.160591969 -0.009362444
## [43,] -0.010925579 -0.010925579 -0.010311783 -0.010189023  1.217772442
## [44,] -0.012673672 -0.012673672 -0.011961668 -0.011819267 -0.011392065
## [45,] -0.012819346 -0.012819346 -0.012099158 -0.011955121 -0.011523008
## [46,] -0.011435440 -0.011435440 -0.010792999 -0.010664511 -0.010279047
## [47,] -0.012819346 -0.012819346 -0.012099158 -0.011955121 -0.011523008
## [48,] -0.013620556 -0.013620556 -0.012855356 -0.012702316 -0.012243196
## [49,] -0.013365625 -0.013365625 -0.012614748 -0.012464572 -0.012014045
## [50,] -0.006446092 -0.006446092 -0.006083952 -0.006011524 -0.005794240
##              [,44]        [,45]        [,46]        [,47]        [,48]
##  [1,] -0.006622865 -0.006223897 -0.006064310 -0.005824930 -0.005984517
##  [2,] -0.011785304 -0.011075346 -0.010791363 -0.010365388 -0.010649371
##  [3,] -0.010868292 -0.010213575 -0.009951689 -0.009558859 -0.009820745
##  [4,] -0.009102194 -0.008553869 -0.008334539 -0.008005544 -0.008224874
##  [5,] -0.008490853 -0.007979356 -0.007774757 -0.007467859 -0.007672457
##  [6,] -0.013721218 -0.012894639 -0.012564007 -0.012068059 -0.012398691
##  [7,] -0.011581523 -0.010883841 -0.010604768 -0.010186159 -0.010465232
##  [8,] -0.012838170 -0.012064786 -0.011755432 -0.011291402 -0.011600756
##  [9,] -0.007709694 -0.007245255 -0.007059479 -0.006780816 -0.006966591
## [10,] -0.010358841 -0.009734814 -0.009485203 -0.009110787 -0.009360398
## [11,] -0.008660670 -0.008138943 -0.007930252 -0.007617216 -0.007825907
## [12,] -0.009339938 -0.008777291 -0.008552233 -0.008214644 -0.008439703
## [13,] -0.010528658 -0.009894401 -0.009640698 -0.009260145 -0.009513847
## [14,] -0.008762560 -0.008234695 -0.008023549 -0.007706830 -0.007917976
## [15,] -0.009713536 -0.009128383 -0.008894322 -0.008543230 -0.008777291
## [16,] -0.008728597 -0.008202778 -0.007992450 -0.007676959 -0.007887286
## [17,] -0.011513597 -0.010820006 -0.010542570 -0.010126416 -0.010403852
## [18,] -0.012532499 -0.011777529 -0.011475541 -0.011022559 -0.011324547
## [19,] -0.010936219 -0.010277410 -0.010013887 -0.009618602 -0.009882125
## [20,] -0.012328718 -0.011586024 -0.011288947 -0.010843331 -0.011140408
## [21,] -0.012464572 -0.011713694 -0.011413343 -0.010962816 -0.011263167
## [22,] -0.012023048 -0.011298768 -0.011009056 -0.010574488 -0.010864200
## [23,] -0.012090974 -0.011362603 -0.011071254 -0.010634231 -0.010925579
## [24,] -0.012770243 -0.012000951 -0.011693234 -0.011231659 -0.011539376
## [25,] -0.010528658 -0.009894401 -0.009640698 -0.009260145 -0.009513847
## [26,] -0.014332560 -0.013469152 -0.013123790 -0.012605745 -0.012951108
## [27,] -0.009509755 -0.008936878 -0.008707728 -0.008364002 -0.008593152
## [28,] -0.011853231 -0.011139181 -0.010853561 -0.010425131 -0.010710751
## [29,] -0.013347621 -0.012543547 -0.012221918 -0.011739474 -0.012061103
## [30,] -0.012634389 -0.011873281 -0.011568838 -0.011112174 -0.011416617
## [31,] -0.011377743 -0.010692337 -0.010418174 -0.010006930 -0.010281093
## [32,] -0.011921157 -0.011203015 -0.010915759 -0.010484873 -0.010772130
## [33,] -0.010358841 -0.009734814 -0.009485203 -0.009110787 -0.009360398
## [34,] -0.010800365 -0.010149740 -0.009889491 -0.009499116 -0.009759366
## [35,] -0.011649450 -0.010947676 -0.010666966 -0.010245902 -0.010526612
## [36,] -0.010324877 -0.009702897 -0.009454104 -0.009080916 -0.009329708
## [37,] -0.009204085 -0.008649622 -0.008427836 -0.008095159 -0.008316944
## [38,] -0.011989084 -0.011266850 -0.010977957 -0.010544616 -0.010833510
## [39,] -0.011887194 -0.011171098 -0.010884660 -0.010455002 -0.010741440
## [40,] -0.012566462 -0.011809446 -0.011506640 -0.011052431 -0.011355237
## [41,] -0.013279694 -0.012479712 -0.012159720 -0.011679731 -0.011999723
## [42,] -0.009713536 -0.009128383 -0.008894322 -0.008543230 -0.008777291
## [43,] -0.010189023 -0.009575227 -0.009329708 -0.008961430 -0.009206949
## [44,]  1.412188830 -0.011107263 -0.010822462 -0.010395259 -0.010680061
## [45,] -0.011955121  1.429141073 -0.010946858 -0.010514745 -0.010802820
## [46,] -0.010664511 -0.010022071  1.275115775 -0.009379630 -0.009636607
## [47,] -0.011955121 -0.011234933 -0.010946858  1.429861261 -0.010802820
## [48,] -0.012702316 -0.011937116 -0.011631036 -0.011171916  1.518921510
## [49,] -0.012464572 -0.011713694 -0.011413343 -0.010962816 -0.011263167
## [50,] -0.006011524 -0.005649384 -0.005504528 -0.005287244 -0.005432100
##              [,49]        [,50]
##  [1,] -0.005904723 -0.005346168
##  [2,] -0.010507379 -0.009513438
##  [3,] -0.009689802 -0.008773199
##  [4,] -0.008115209 -0.007347554
##  [5,] -0.007570158 -0.006854062
##  [6,] -0.012233375 -0.011076164
##  [7,] -0.010325695 -0.009348941
##  [8,] -0.011446079 -0.010363342
##  [9,] -0.006873703 -0.006223488
## [10,] -0.009235593 -0.008361956
## [11,] -0.007721561 -0.006991143
## [12,] -0.008327174 -0.007539468
## [13,] -0.009386996 -0.008499037
## [14,] -0.007812403 -0.007073392
## [15,] -0.008660261 -0.007841047
## [16,] -0.007782122 -0.007045976
## [17,] -0.010265134 -0.009294108
## [18,] -0.011173553 -0.010116595
## [19,] -0.009750363 -0.008828032
## [20,] -0.010991869 -0.009952098
## [21,] -0.011112992 -0.010061763
## [22,] -0.010719344 -0.009705352
## [23,] -0.010779905 -0.009760184
## [24,] -0.011385518 -0.010308509
## [25,] -0.009386996 -0.008499037
## [26,] -0.012778427 -0.011569657
## [27,] -0.008478577 -0.007676549
## [28,] -0.010567941 -0.009568270
## [29,] -0.011900288 -0.010774585
## [30,] -0.011264395 -0.010198844
## [31,] -0.010144012 -0.009184443
## [32,] -0.010628502 -0.009623103
## [33,] -0.009235593 -0.008361956
## [34,] -0.009629241 -0.008718367
## [35,] -0.010386257 -0.009403773
## [36,] -0.009205312 -0.008334539
## [37,] -0.008206051 -0.007429803
## [38,] -0.010689063 -0.009677935
## [39,] -0.010598221 -0.009595687
## [40,] -0.011203834 -0.010144012
## [41,] -0.011839727 -0.010719753
## [42,] -0.008660261 -0.007841047
## [43,] -0.009084190 -0.008224874
## [44,] -0.010537660 -0.009540854
## [45,] -0.010658782 -0.009650519
## [46,] -0.009508118 -0.008608702
## [47,] -0.010658782 -0.009650519
## [48,] -0.011324956 -0.010253677
## [49,]  1.490642674 -0.010061763
## [50,] -0.005359672  0.719427304
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the xtable package}
\FunctionTok{library}\NormalTok{(xtable)}

\CommentTok{\# Extract coefficients}
\NormalTok{coefficients }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(iv2a\_6)}

\CommentTok{\# Get the number of products}
\NormalTok{num\_products }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(cerealdata)}

\CommentTok{\# Initialize an empty matrix to store the elasticities}
\NormalTok{elasticity\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_products, }\AttributeTok{ncol =}\NormalTok{ num\_products)}

\CommentTok{\# Calculate own{-}price elasticity (j = k) and cross{-}price elasticity (j  k)}
\ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_products) \{}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_products) \{}
    \ControlFlowTok{if}\NormalTok{ (j }\SpecialCharTok{==}\NormalTok{ k) \{}
      \CommentTok{\# Calculate own{-}price elasticity}
\NormalTok{      elasticity\_matrix[j, k] }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{coefficients[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{[j] }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{[j]}\SpecialCharTok{/}\DecValTok{100}\NormalTok{))}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
      \CommentTok{\# Calculate cross{-}price elasticity}
\NormalTok{      elasticity\_matrix[j, k] }\OtherTok{\textless{}{-}}\NormalTok{ coefficients[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{[j] }\SpecialCharTok{*}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{[k]}\SpecialCharTok{/}\DecValTok{100}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# Create a LaTeX table}
\NormalTok{latex\_table }\OtherTok{\textless{}{-}} \FunctionTok{xtable}\NormalTok{(elasticity\_matrix, }\AttributeTok{caption =} \StringTok{"Elasticity Matrix"}\NormalTok{)}

\CommentTok{\# Write the LaTeX table to a file}
\FunctionTok{print}\NormalTok{(latex\_table, }\AttributeTok{file =} \StringTok{"elasticity\_matrix.tex"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extract coefficients}
\NormalTok{coefficients }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(iv2a\_6)}

\CommentTok{\# Get the number of products}
\NormalTok{num\_products }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(cerealdata)}

\CommentTok{\# Initialize an empty matrix to store the elasticities}
\NormalTok{elasticity\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_products, }\AttributeTok{ncol =}\NormalTok{ num\_products)}

\CommentTok{\# Calculate own{-}price elasticity (j = k) and cross{-}price elasticity (j  k)}
\ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_products) \{}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_products) \{}
    \ControlFlowTok{if}\NormalTok{ (j }\SpecialCharTok{==}\NormalTok{ k) \{}
      \CommentTok{\# Calculate own{-}price elasticity}
\NormalTok{      elasticity\_matrix[j, k] }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{coefficients[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{[j] }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{[j]}\SpecialCharTok{/}\DecValTok{100}\NormalTok{))}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
      \CommentTok{\# Calculate cross{-}price elasticity}
\NormalTok{      elasticity\_matrix[j, k] }\OtherTok{\textless{}{-}}\NormalTok{ coefficients[}\StringTok{"fit\_\textasciigrave{}Avg Shelf Price\textasciigrave{}"}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Avg Shelf Price}\StringTok{\textasciigrave{}}\NormalTok{[j] }\SpecialCharTok{*}\NormalTok{ (cerealdata}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Mkt Share}\StringTok{\textasciigrave{}}\NormalTok{[k]}\SpecialCharTok{/}\DecValTok{100}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# Convert the matrix to a data frame for xtable}
\NormalTok{df\_elasticity }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(elasticity\_matrix)}

\CommentTok{\# Creating LaTeX code for the table}
\NormalTok{latex\_table }\OtherTok{\textless{}{-}} \FunctionTok{xtable}\NormalTok{(df\_elasticity, }\AttributeTok{caption =} \StringTok{"Elasticity Matrix"}\NormalTok{, }\AttributeTok{label =} \StringTok{"tab:elasticity\_matrix"}\NormalTok{)}

\CommentTok{\# Printing the LaTeX code for the table}
\FunctionTok{print}\NormalTok{(latex\_table, }\AttributeTok{type =} \StringTok{"latex"}\NormalTok{, }\AttributeTok{include.rownames =} \ConstantTok{FALSE}\NormalTok{, }
      \AttributeTok{sanitize.text.function =} \ControlFlowTok{function}\NormalTok{(x)\{x\},}
      \AttributeTok{floating =} \ConstantTok{FALSE}\NormalTok{, }
      \AttributeTok{hline.after =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(df\_elasticity)), }
      \AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## % latex table generated in R 4.3.2 by xtable 1.8-4 package
## % Fri Oct  3 17:40:06 2025
## \begin{tabular}{rrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr}
##   \toprule
## V1 & V2 & V3 & V4 & V5 & V6 & V7 & V8 & V9 & V10 & V11 & V12 & V13 & V14 & V15 & V16 & V17 & V18 & V19 & V20 & V21 & V22 & V23 & V24 & V25 & V26 & V27 & V28 & V29 & V30 & V31 & V32 & V33 & V34 & V35 & V36 & V37 & V38 & V39 & V40 & V41 & V42 & V43 & V44 & V45 & V46 & V47 & V48 & V49 & V50 \\ 
##   \midrule
## 0.75 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & 1.36 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.06 & 1.26 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.05 & -0.04 & 1.05 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.04 & -0.04 & -0.04 & 1.00 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.07 & -0.06 & -0.05 & 1.61 & -0.04 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & 1.36 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & 1.51 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.05 & -0.04 & -0.04 & -0.04 & -0.03 & -0.02 & -0.02 & -0.02 & 0.91 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.05 & -0.05 & -0.05 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & 1.22 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.05 & -0.04 & -0.04 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.05 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & 1.10 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.06 & -0.05 & -0.05 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & 1.25 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.05 & -0.04 & -0.04 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.04 & -0.02 & -0.02 & -0.01 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.05 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.15 & -0.02 & -0.01 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.05 & -0.04 & -0.04 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.04 & -0.01 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & 1.37 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.49 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.06 & -0.05 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.30 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.47 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.48 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.06 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.43 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.06 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.44 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.52 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.06 & -0.05 & -0.05 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.25 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.10 & -0.08 & -0.07 & -0.07 & -0.05 & -0.04 & -0.04 & -0.04 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.71 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.05 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.13 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.41 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.59 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.51 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & 1.36 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & 1.42 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.05 & -0.05 & -0.05 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.24 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.06 & -0.05 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.29 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & 1.39 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.05 & -0.05 & -0.05 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.23 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.06 & -0.05 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.10 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.06 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.43 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.42 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.50 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & 1.59 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.05 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.16 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.05 & -0.05 & -0.05 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.22 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.41 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.06 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.43 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.07 & -0.06 & -0.05 & -0.05 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.28 & -0.01 & -0.01 & -0.01 & -0.01 \\ 
##   -0.08 & -0.06 & -0.06 & -0.06 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.43 & -0.01 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.52 & -0.01 & -0.01 \\ 
##   -0.09 & -0.07 & -0.06 & -0.06 & -0.04 & -0.04 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 1.49 & -0.01 \\ 
##   -0.04 & -0.03 & -0.03 & -0.03 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.02 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & -0.01 & 0.72 \\ 
##    \bottomrule
## \end{tabular}
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Saving the LaTeX code to a file}
\FunctionTok{writeLines}\NormalTok{(}\FunctionTok{capture.output}\NormalTok{(}\FunctionTok{print}\NormalTok{(latex\_table, }\AttributeTok{type =} \StringTok{"latex"}\NormalTok{, }\AttributeTok{include.rownames =} \ConstantTok{FALSE}\NormalTok{, }
                                \AttributeTok{sanitize.text.function =} \ControlFlowTok{function}\NormalTok{(x)\{x\},}
                                \AttributeTok{floating =} \ConstantTok{FALSE}\NormalTok{,}
                                \AttributeTok{hline.after =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(df\_elasticity)),}
                                \AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{)),}
           \StringTok{"elasticity\_matrix.tex"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}


\end{document}
